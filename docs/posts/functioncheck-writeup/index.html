<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>CyberEdu function-check Writeup | Irina&#39;s CTF Writeups</title>
<meta name="keywords" content="CyberEdu, pwn, format-string">
<meta name="description" content="Challenge overview
We need a master to manipulate the syntax of a program.

At first glance, the format looks like a 32-bit executable, and it doesn&rsquo;t really look like it&rsquo;s going to be fun to test locally, so let&rsquo;s just try it remotely right away.
Upon checking, every protection is disabled, so that&rsquo;s nice! Now let&rsquo;s take a look at the binary.

Pretty straight forward, we have a main function and a printFlag function. As the binary name suggests, a fmtstr vulnerability, and a value demo_3187 we&rsquo;re supposed to overwrite.">
<meta name="author" content="">
<link rel="canonical" href="https://irinasusca.github.io/writeup-blog/posts/functioncheck-writeup/">
<link crossorigin="anonymous" href="/writeup-blog/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css" integrity="sha256-NDzEgLn/yPBMy&#43;XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://irinasusca.github.io/writeup-blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://irinasusca.github.io/writeup-blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://irinasusca.github.io/writeup-blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://irinasusca.github.io/writeup-blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://irinasusca.github.io/writeup-blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://irinasusca.github.io/writeup-blog/posts/functioncheck-writeup/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="https://irinasusca.github.io/writeup-blog/posts/functioncheck-writeup/">
  <meta property="og:site_name" content="Irina&#39;s CTF Writeups">
  <meta property="og:title" content="CyberEdu function-check Writeup">
  <meta property="og:description" content="Challenge overview We need a master to manipulate the syntax of a program.
At first glance, the format looks like a 32-bit executable, and it doesn’t really look like it’s going to be fun to test locally, so let’s just try it remotely right away.
Upon checking, every protection is disabled, so that’s nice! Now let’s take a look at the binary.
Pretty straight forward, we have a main function and a printFlag function. As the binary name suggests, a fmtstr vulnerability, and a value demo_3187 we’re supposed to overwrite.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-12-21T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-12-21T00:00:00+00:00">
    <meta property="article:tag" content="CyberEdu">
    <meta property="article:tag" content="Pwn">
    <meta property="article:tag" content="Format-String">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CyberEdu function-check Writeup">
<meta name="twitter:description" content="Challenge overview
We need a master to manipulate the syntax of a program.

At first glance, the format looks like a 32-bit executable, and it doesn&rsquo;t really look like it&rsquo;s going to be fun to test locally, so let&rsquo;s just try it remotely right away.
Upon checking, every protection is disabled, so that&rsquo;s nice! Now let&rsquo;s take a look at the binary.

Pretty straight forward, we have a main function and a printFlag function. As the binary name suggests, a fmtstr vulnerability, and a value demo_3187 we&rsquo;re supposed to overwrite.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://irinasusca.github.io/writeup-blog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "CyberEdu function-check Writeup",
      "item": "https://irinasusca.github.io/writeup-blog/posts/functioncheck-writeup/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CyberEdu function-check Writeup",
  "name": "CyberEdu function-check Writeup",
  "description": "Challenge overview We need a master to manipulate the syntax of a program.\nAt first glance, the format looks like a 32-bit executable, and it doesn\u0026rsquo;t really look like it\u0026rsquo;s going to be fun to test locally, so let\u0026rsquo;s just try it remotely right away.\nUpon checking, every protection is disabled, so that\u0026rsquo;s nice! Now let\u0026rsquo;s take a look at the binary.\nPretty straight forward, we have a main function and a printFlag function. As the binary name suggests, a fmtstr vulnerability, and a value demo_3187 we\u0026rsquo;re supposed to overwrite.\n",
  "keywords": [
    "CyberEdu", "pwn", "format-string"
  ],
  "articleBody": "Challenge overview We need a master to manipulate the syntax of a program.\nAt first glance, the format looks like a 32-bit executable, and it doesn’t really look like it’s going to be fun to test locally, so let’s just try it remotely right away.\nUpon checking, every protection is disabled, so that’s nice! Now let’s take a look at the binary.\nPretty straight forward, we have a main function and a printFlag function. As the binary name suggests, a fmtstr vulnerability, and a value demo_3187 we’re supposed to overwrite.\nIdentifying the vulnerabilities Since this is clearly a format string vulnerability, we’re going to be using pwntools’ great tool fmtstr_payload(). All we need to know is the format string offset on the stack, and we can calculate that fairly easily.\nLooking at the stack value where our first input gets shown, we can see the offset here is 4 (by counting); we need to take in consideration the ‘Break stuff’ part of the string as well.\nBreak stuff. 0xffd88618 \u003c-- 1 0xc8 \u003c-- 2 (nil) \u003c-- 3 0x61657242 \u003c-- 4 ('Brea') 0x7473206b \u003c-- 5 ('k st') 0x2e666675 \u003c-- 6 ('uff.') 0x70252020 \u003c-- 7 (' %p') 0x20702520 \u003c-- 8 0x25207025 \u003c-- 9 ... We already get to see the location of the thing we want to modify, so no need to bother with that, and we just need to change that to 0x20.\nEOF… and another EOF… and so on…\nI tried doing so with quite a couple of different fmtstr payloads, but apparently there is an issue with that: fmtstr_payload appends addresses to the end of the payload, using %$n to write to those appended addresses. And the printf that was being used by them without an argument was messing with a bunch of stuff, like the offset, and it wasn’t displaying data in the way it was supposed to. And the address we wanted to modify wasn’t properly becoming a part of the stack frame.\nprintf(user_input); # BAD printf(user_input, arg); # fmtstr_payload-friendly Plus, if %p shows string bytes, that’s another sign we need to manually make our payload.\nThe Manual Exploit We’re going to be using %n for this. What this does is take the current output byte count and store it at the given address. So we need to make a payload with a length of 32, so that we can overwrite what’s at value 0x804a030 for example with the length of our payload (32). %n is basically telling printf where to store the amount of bytes written this far. It isn’t a magical write what I want where I want, so we need to play by its rules.\nAfter a little bit of testing, it looks like the offset our prefixed address (because we add it before the %n, in p32 format) ends up at is 9. So keeping that in mind, let’s finish building our offset. %nr$c just writes a character as padding nr times so we’re going to be using that to reach the required number of bytes.\nSince I figured the string length of the %9$p was 4, I thought I should keep it as 4 to not modify the offset from 9.\n#payload = b\"%9$p\" #lets keep it as 4 bytes payload = b\"byte\" #4 bytes payload += p32(0x804a030) # 4 bytes, 8 in total payload += b\"%21$c\" #add another 21 bytes # so 32 in total now payload += b\"%8$n\" #modify the address at offset 9 with total length #doesnt actually print anything so it doesnt modify length But once again, I kept getting EOF, so I thought to take another look at it with\npayload = b\"AAAA\" + p32(0x804a030) + b\".\" + b\"%p.\" * 20 And we got this:\nThe value was right there, split between the 8th and 9th offset. So we needed to modify that 4-byte padding, to push it and have it occupy and entire offset value, instead of the current thing.\nWith the buffer AAAAA of length 5, the 8th and 9th offest looked like this: 0x30414141.0x2e0804a0.\nWith the buffer AAAAAA of length 6, they looked like this: 0x41414141.0x804a030!\nThat made me think, this just made us shift the whole address by 6 bytes, so we could probably just use 2 bytes instead of 6 and have it cover the 8th offset instead of the 9th (I was correct):\nSo let’s build the final payload that way.\nFinally, we did something! For some reason though, we need 5 more bytes in length, can’t really tell why, but at this point we can just change the %x$c offset and take the win.\nAfter modifying the %c thing, it looks like whatever we give it we end up with that 0x15, so I just moved to manually writing bytes. In the end, the payload that worked was this:\n#payload = b\"%9$p\" #lets keep it as 4 bytes payload = b\"by\" #2 bytes payload += p32(0x804a030) # 4 bytes, 6 in total payload += b\"c\"*12 #add another 26 bytes theoretically #no clue why 'c'*12 is 26 bytes but whatever # so 32 in total now payload += b\"%8$n\" #modify the address at offset 8 with total length #doesnt actually print anything so it doesnt modify length And of course, it worked!\nAs always, the full code can be found on my GitHub here.\n",
  "wordCount" : "883",
  "inLanguage": "en",
  "datePublished": "2025-12-21T00:00:00Z",
  "dateModified": "2025-12-21T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://irinasusca.github.io/writeup-blog/posts/functioncheck-writeup/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Irina's CTF Writeups",
    "logo": {
      "@type": "ImageObject",
      "url": "https://irinasusca.github.io/writeup-blog/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://irinasusca.github.io/writeup-blog/" accesskey="h" title="Irina&#39;s CTF Writeups (Alt + H)">Irina&#39;s CTF Writeups</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      CyberEdu function-check Writeup
    </h1>
    <div class="post-meta"><span title='2025-12-21 00:00:00 +0000 UTC'>December 21, 2025</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#challenge-overview" aria-label="Challenge overview">Challenge overview</a></li>
                <li>
                    <a href="#identifying-the-vulnerabilities" aria-label="Identifying the vulnerabilities">Identifying the vulnerabilities</a></li>
                <li>
                    <a href="#the-manual-exploit" aria-label="The Manual Exploit">The Manual Exploit</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="challenge-overview">Challenge overview<a hidden class="anchor" aria-hidden="true" href="#challenge-overview">#</a></h2>
<p>We need a master to manipulate the syntax of a <strong><a href="https://app.cyber-edu.co/challenges/08ef6340-c1e4-11eb-9b9f-6bd8e9c6de87?tenant=cyberedu">program</a></strong>.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/functioncheck-writeup/pic1.png#center"></p>
<p>At first glance, the <strong>format</strong> looks like a 32-bit executable, and it doesn&rsquo;t really look like it&rsquo;s going to be fun to test locally, so let&rsquo;s just try it remotely right away.</p>
<p>Upon checking, every protection is disabled, so that&rsquo;s nice! Now let&rsquo;s take a look at the binary.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/functioncheck-writeup/pic2.png#center"></p>
<p>Pretty straight forward, we have a <code>main</code> function and a <code>printFlag</code> function. As the binary name suggests, a fmtstr vulnerability, and a value <code>demo_3187</code> we&rsquo;re supposed to overwrite.</p>
<hr>
<h2 id="identifying-the-vulnerabilities">Identifying the vulnerabilities<a hidden class="anchor" aria-hidden="true" href="#identifying-the-vulnerabilities">#</a></h2>
<p>Since this is clearly a format string vulnerability, we&rsquo;re going to be using <code>pwntools</code>&rsquo; great tool <code>fmtstr_payload()</code>. All we need to know is the format string offset on the stack, and we can calculate that fairly easily.</p>
<p>Looking at the stack value where our first input gets shown, we can see the offset here is 4 (by counting); we need to take in consideration the &lsquo;Break stuff&rsquo; part of the string as well.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>Break stuff<span style="color:#f92672">.</span>  
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0xffd88618</span>   <span style="color:#f92672">&lt;--</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0xc8</span>         <span style="color:#f92672">&lt;--</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>(nil)        <span style="color:#f92672">&lt;--</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0x61657242</span>   <span style="color:#f92672">&lt;--</span> <span style="color:#ae81ff">4</span>  (<span style="color:#e6db74">&#39;Brea&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0x7473206b</span>   <span style="color:#f92672">&lt;--</span> <span style="color:#ae81ff">5</span>  (<span style="color:#e6db74">&#39;k st&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0x2e666675</span>   <span style="color:#f92672">&lt;--</span> <span style="color:#ae81ff">6</span>  (<span style="color:#e6db74">&#39;uff.&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0x70252020</span>   <span style="color:#f92672">&lt;--</span> <span style="color:#ae81ff">7</span>  (<span style="color:#e6db74">&#39;  %p&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0x20702520</span>   <span style="color:#f92672">&lt;--</span> <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0x25207025</span>   <span style="color:#f92672">&lt;--</span> <span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">...</span>
</span></span></code></pre></div><p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/functioncheck-writeup/pic3.png#center"></p>
<p>We already get to see the location of the thing we want to modify, so no need to bother with that, and we just need to change that to <code>0x20</code>.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/functioncheck-writeup/pic4.png#center"></p>
<p><code>EOF</code>&hellip; and another <code>EOF</code>&hellip; and so on&hellip;</p>
<p>I tried doing so with quite a couple of different fmtstr payloads, but apparently there is an issue with that: fmtstr_payload appends addresses to the end of the payload, using <code>%&lt;offset&gt;$n</code> to write to those appended addresses. And the <code>printf</code> that was being used by them without an argument was messing with a bunch of stuff, like the offset, and it wasn&rsquo;t displaying data in the way it was supposed to. And the address we wanted to modify wasn&rsquo;t properly becoming a part of the stack frame.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>printf(user_input);       <span style="color:#75715e"># BAD</span>
</span></span><span style="display:flex;"><span>printf(user_input, arg);  <span style="color:#75715e"># fmtstr_payload-friendly</span>
</span></span></code></pre></div><p>Plus, if <code>%p</code> shows string bytes, that&rsquo;s another sign we need to manually make our payload.</p>
<hr>
<h2 id="the-manual-exploit">The Manual Exploit<a hidden class="anchor" aria-hidden="true" href="#the-manual-exploit">#</a></h2>
<p>We&rsquo;re going to be using <code>%n</code> for this. What this does is take the current output byte count and store it at the given address. So we need to make a payload with a length of <code>32</code>, so that we can overwrite what&rsquo;s at value <code>0x804a030</code> for example with the length of our payload (<code>32</code>). <code>%n</code> is basically telling <code>printf</code> where to store the amount of bytes written this far. It isn&rsquo;t a magical write what I want where I want, so we need to play by its rules.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/functioncheck-writeup/pic5.png#center"></p>
<p>After a little bit of testing, it looks like the offset our prefixed address (because we add it before the <code>%n</code>, in <code>p32</code> format) ends up at is 9. So keeping that in mind, let&rsquo;s finish building our offset. <code>%nr$c</code> just writes a character as padding <code>nr</code> times so we&rsquo;re going to be using that to reach the required number of bytes.</p>
<p>Since I figured the string length of the <code>%9$p</code> was 4, I thought I should keep it as 4 to not modify the offset from 9.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#payload  = b&#34;%9$p&#34;         #lets keep it as 4 bytes</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;byte&#34;</span> <span style="color:#75715e">#4 bytes</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">+=</span> p32(<span style="color:#ae81ff">0x804a030</span>) <span style="color:#75715e"># 4 bytes, 8 in total  </span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%21$c&#34;</span> <span style="color:#75715e">#add another 21 bytes</span>
</span></span><span style="display:flex;"><span>		    <span style="color:#75715e"># so 32 in total now</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%8$n&#34;</span> <span style="color:#75715e">#modify the address at offset 9 with total length</span>
</span></span><span style="display:flex;"><span>		   <span style="color:#75715e">#doesnt actually print anything so it doesnt modify length</span>
</span></span><span style="display:flex;"><span>		   
</span></span></code></pre></div><p>But once again, I kept getting <code>EOF</code>, so I thought to take another look at it with</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;AAAA&#34;</span> <span style="color:#f92672">+</span> p32(<span style="color:#ae81ff">0x804a030</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;.&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%p.&#34;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">20</span>
</span></span></code></pre></div><p>And we got this:</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/functioncheck-writeup/pic6.png#center"></p>
<p>The value was right there, <em>split between</em> the 8th and 9th offset. So we needed to modify that 4-byte padding, to push it and have it occupy and entire offset value, instead of the current thing.</p>
<p>With the buffer <code>AAAAA</code> of length 5, the 8th and 9th offest looked like this: <code>0x30414141.0x2e0804a0</code>.</p>
<p>With the buffer <code>AAAAAA</code> of length 6, they looked like this: <code>0x41414141.0x804a030</code>!</p>
<p>That made me think, this just made us shift the whole address by 6 bytes, so we could probably just use 2 bytes instead of 6 and have it cover the 8th offset instead of the 9th (I was correct):</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/functioncheck-writeup/pic7.png#center"></p>
<p>So let&rsquo;s build the final payload that way.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/functioncheck-writeup/pic8.png#center"></p>
<p>Finally, we did something! For some reason though, we need 5 more bytes in length, can&rsquo;t really tell why, but at this point we can just change the <code>%x$c</code> offset and take the win.</p>
<p>After modifying the <code>%c</code> thing, it looks like whatever we give it we end up with that <code>0x15</code>, so I just moved to manually writing bytes. In the end, the payload that worked was this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#payload  = b&#34;%9$p&#34;         #lets keep it as 4 bytes</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;by&#34;</span> <span style="color:#75715e">#2 bytes</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">+=</span> p32(<span style="color:#ae81ff">0x804a030</span>) <span style="color:#75715e"># 4 bytes, 6 in total  </span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;c&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">12</span> <span style="color:#75715e">#add another 26 bytes theoretically</span>
</span></span><span style="display:flex;"><span>		   <span style="color:#75715e">#no clue why &#39;c&#39;*12 is 26 bytes but whatever</span>
</span></span><span style="display:flex;"><span>		    <span style="color:#75715e"># so 32 in total now</span>
</span></span><span style="display:flex;"><span>		    
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%8$n&#34;</span> <span style="color:#75715e">#modify the address at offset 8 with total length</span>
</span></span><span style="display:flex;"><span>		   <span style="color:#75715e">#doesnt actually print anything so it doesnt modify length</span>
</span></span><span style="display:flex;"><span>		   
</span></span></code></pre></div><hr>
<p>And of course, it worked!</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/functioncheck-writeup/pic9.png#center"></p>
<hr>
<p>As always, the full code can be found on my GitHub
<strong><a href="https://github.com/irinasusca/ctf-writeups/blob/main/cyberedu/functioncheck.py">here</a></strong>.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/cyberedu/">CyberEdu</a></li>
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/pwn/">Pwn</a></li>
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/format-string/">Format-String</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="https://irinasusca.github.io/writeup-blog/">Irina&#39;s CTF Writeups</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
