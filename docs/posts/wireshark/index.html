<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Wireshark, tshark &amp; sorting | Irina&#39;s CTF Writeups</title>
<meta name="keywords" content="Materials, web">
<meta name="description" content="Why
Since this is, sadly, something that needs to be done in order to score points in ctfs, I&rsquo;m going to cover some things that I feel  are important in this category.
I have done quite a few forensics challenges, but I never really mastered grep and tshark to their full potential. And I forgot most of my Wireshark expertise from last year, so I&rsquo;ll include what I feel is important or non-intuitive about that as well.">
<meta name="author" content="">
<link rel="canonical" href="https://irinasusca.github.io/writeup-blog/posts/wireshark/">
<link crossorigin="anonymous" href="/writeup-blog/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css" integrity="sha256-NDzEgLn/yPBMy&#43;XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://irinasusca.github.io/writeup-blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://irinasusca.github.io/writeup-blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://irinasusca.github.io/writeup-blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://irinasusca.github.io/writeup-blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://irinasusca.github.io/writeup-blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://irinasusca.github.io/writeup-blog/posts/wireshark/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="https://irinasusca.github.io/writeup-blog/posts/wireshark/">
  <meta property="og:site_name" content="Irina&#39;s CTF Writeups">
  <meta property="og:title" content="Wireshark, tshark & sorting">
  <meta property="og:description" content="Why Since this is, sadly, something that needs to be done in order to score points in ctfs, I’m going to cover some things that I feel are important in this category.
I have done quite a few forensics challenges, but I never really mastered grep and tshark to their full potential. And I forgot most of my Wireshark expertise from last year, so I’ll include what I feel is important or non-intuitive about that as well.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2026-02-01T00:00:00+00:00">
    <meta property="article:modified_time" content="2026-02-01T00:00:00+00:00">
    <meta property="article:tag" content="Materials">
    <meta property="article:tag" content="Web">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Wireshark, tshark &amp; sorting">
<meta name="twitter:description" content="Why
Since this is, sadly, something that needs to be done in order to score points in ctfs, I&rsquo;m going to cover some things that I feel  are important in this category.
I have done quite a few forensics challenges, but I never really mastered grep and tshark to their full potential. And I forgot most of my Wireshark expertise from last year, so I&rsquo;ll include what I feel is important or non-intuitive about that as well.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://irinasusca.github.io/writeup-blog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Wireshark, tshark \u0026 sorting",
      "item": "https://irinasusca.github.io/writeup-blog/posts/wireshark/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Wireshark, tshark \u0026 sorting",
  "name": "Wireshark, tshark \u0026 sorting",
  "description": "Why Since this is, sadly, something that needs to be done in order to score points in ctfs, I\u0026rsquo;m going to cover some things that I feel are important in this category.\nI have done quite a few forensics challenges, but I never really mastered grep and tshark to their full potential. And I forgot most of my Wireshark expertise from last year, so I\u0026rsquo;ll include what I feel is important or non-intuitive about that as well.\n",
  "keywords": [
    "Materials", "web"
  ],
  "articleBody": "Why Since this is, sadly, something that needs to be done in order to score points in ctfs, I’m going to cover some things that I feel are important in this category.\nI have done quite a few forensics challenges, but I never really mastered grep and tshark to their full potential. And I forgot most of my Wireshark expertise from last year, so I’ll include what I feel is important or non-intuitive about that as well.\nI’m writing this as I learn, so keep that in mind.\nGrep Feel free to skip this if you already know your stuff with grep. I for one always avoided learning this in depth, so that’s what I’ll be doing now.\nWe all know the basic syntax, grep \"string\" /path/file. There is also the color-text-in-file --color parameter.\nTo ignore case sensitivity, just add an -i before the string.\nTo just count the lines in which the text appears, -c. If you want to see them and number them, use -n.\nTo invert the grep output, add a -v; this means print all the lines that don’t contain the expression.\nFor an exact word, use -w, meaning it won’t print a word if it’s a suffix/prefix.\nIf we only want the matches, and not the lines, add an -o.\nObviously the most useful grep is, is as a pipe. So if we want to see if openSSH has been installed on our system, we can just do dpkg -L | grep -i \"openssh\".\nThe -A 4 will print the line with our string and then 4 more lines coming after, and -B 4 the string and its 4 preceding lines (you know, after, before..).\nNow time for REGEX (REGular EXpressions)! A REGEX is a sequence of characters that is used to match a pattern.\nTo search for an expression, we add an -E (for example, looking for first|second, looking for either words).\nThe ^ and $ are used as anchors; ^c means line begins with c, and c$ means line ends with c.\nThe dot . is a one character wildcard, meaning any character. If you mean the actual dot, escape by using a \\ like \\..\nThe full wildcard is *, can also be used for files, like *.txt means look in all files with that extension.\nIf instead of a wildcard, we mean to search a certain range, we use the [..] syntax. An example is grep -w '[sS]ample[0-9]' file. We can also use [A-Za-z] for letters. If we want to negate a range, we can use a ^ as in [^0-9].\nIf we want an AND, we just pipe the output through another grep.\nWe can also test how many times a character must be repeated in a sequence, with {N}. This can also be a range, like {min,max}. For example, to match both col and cool, we can use grep -E 'co{1,2}l' file. If we don’t specify a maximum, like {N,}, it means at least N characters.\nA useful source I used was this.\nSort Now a word about using sort because I came across this in a challenge and had to resort to ChatGPT to do it, and we can’t have that. Just using sort filename sorts the lines alphabetically.\nNow let’s look at the flags. -r for reverse order, -n to sort numerically, k to sort based on a specific column number, -u to remove duplicates.\n-t specifies a delimiter for fields, which if unspecified, is automatically space. And -k1 means from field 1 to end of line while -k1,1 means to only use that one field.\nSed Turns out sed (stream editor) is quite important as well. The source I’ll be referencing is here.\nSubstitution: sed 's/pattern/replacement/flags' file - Replace the first occurrence of pattern with replacement. Some flags are: sed 's/foo/bar/g' file.txt for global substitution (all of them);\nsed 's/foo/bar/i' file.txt is case insensitive search;\nsed 's/foo/bar/2 file.txt replaces the n-th occurrence of foo with bar (in this case, 2).\nDeletion: sed '/pattern/d' file. To delete blank lines for example, we can do sed '/^$/d' file.txt.\nTo delete all lines starting with a digit, just like grep, sed '/^[0-9]/d' file.txt.\nPrinting: We can print lines matching a pattern, often with -n as a flag to suppress the normal behaviour of sed which just prints everything: sed -n '/pattern/p' file. To print matching lines with the next line, sed -n '/error/{N; p}' file.txt. This prints lines containing error along with the following lines. Insertion, to add a line before the pattern-found-line: sed 'line_number i\\text_to_insert' file. To insert text before a specific line, sed '2i\\I'm inserted before line 2' file.\nTo insert text before a specific pattern, sed '/error/i\\Next is an error message.'\nAppending: Just like insert, but it’s just after: sed 'line_number a\\text_to_append' file. To append text after a specific line, sed '2a\\I'm after line 2' file.txt.\nTo append text after a specific pattern, sed '/error/a\\I'm after an error' file.txt.\nChange: Just modify the entire content of a line with new text: sed 'line number c\\new_text' file. To change the content of a certain line: sed '2c\\Now I am line 2' file.\nTo replace all matching lines of a pattern: sed '/error/c\\Critical Error' file.txt. This replaces all lines containing error to Critical Error.\nRanges: We can apply sed to a range of lines, too: sed 'start_line, end_line command' file. For example, to delete lines 2 to 4: sed '2,4d' file.\nTo delete text between the first two occurrences of patterns: sed '/start/,/end/d - removes all text between and including the first start and end.\nWe can chain multiple commands, sequentially, using -e. And as I meantioned, by default, sed prints every line, and the -n flag blocks this. The -i flag enables in-place editing aka it modifies the file directly; otherwise, it needs redirection, it doesn’t actually modify our file. And of course like grep, to use RegEx, we need to add the -E flag. And to escape special characters of course we use \\.\nFind Also a useful command in some challs was find, to search system-wide for files containing “ctf” like sudo find / -type f -exec grep -l \"ctf\" {} + 2\u003e/dev/null. Or maybe like grep -RIl \"ctf\" / 2\u003e/dev/null.\nWireshark Now that we have a basic understanding of grep, before we get to the more intimidating tshark, let’s note a few things about Wireshark. Source if you don’t like how I said it.\ntcp.port == 4444 # Match TCP port ip.addr != 10.10.10.10 # Filter out source or destination IP address eth.addr == 00:00:5e:00:53:00 # Filter Ethernet MAC address http # Filter only http traffic http.host contains \"example\" # Filter HTTP host header containing string pkt_comment # Filter on Wireshark comments in the capture We can use || \u0026\u0026 == and != normally.\nThe most important filters are:\ntcp (inlcudes http). We can follow streams (formed by multiple packets).\nhttp which is self explanatory, isn’t it? To download files sent over http, we can look at File -\u003e Export Objects -\u003e HTTP to view all objects and download what we like.\ndns\nUSB Keystrokes, like a USB keyboard for example, sending a lot of URB_INTERRUPT in packets.\nSSL/TLS (transfer layer security, so https) means we need a RSA key to decrypt the data. We can go to Edit -\u003e Preferences -\u003e Protocols -\u003e TLS and add an entry with the IP and port of target, the http protocol and the path to the file containing the key.\ntshark Terminal wireshark. Useful for extracting stuff quickly. This is how our parameters will look like:\n-r - .pcap to read from\n-Y [filter] - filters to apply\n-T fields - display only selected fields\n-e [field] - field name to display\nWe can view the field name clicking on it in Wireshark. I really did think this would be more complicated, but that’s kind of it.\nI made a challenge to demo my new knowledges here, so you can take a look at that if you want.\n",
  "wordCount" : "1332",
  "inLanguage": "en",
  "datePublished": "2026-02-01T00:00:00Z",
  "dateModified": "2026-02-01T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://irinasusca.github.io/writeup-blog/posts/wireshark/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Irina's CTF Writeups",
    "logo": {
      "@type": "ImageObject",
      "url": "https://irinasusca.github.io/writeup-blog/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://irinasusca.github.io/writeup-blog/" accesskey="h" title="Irina&#39;s CTF Writeups (Alt + H)">Irina&#39;s CTF Writeups</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Wireshark, tshark &amp; sorting
    </h1>
    <div class="post-meta"><span title='2026-02-01 00:00:00 +0000 UTC'>February 1, 2026</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul><ul>
                <li>
                    <a href="#why" aria-label="Why">Why</a></li>
                <li>
                    <a href="#grep" aria-label="Grep">Grep</a></li>
                <li>
                    <a href="#sort" aria-label="Sort">Sort</a></li></ul>
                    
                <li>
                    <a href="#sed" aria-label="Sed">Sed</a><ul>
                        
                <li>
                    <a href="#find" aria-label="Find">Find</a></li>
                <li>
                    <a href="#wireshark" aria-label="Wireshark">Wireshark</a></li>
                <li>
                    <a href="#tshark" aria-label="tshark">tshark</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="why">Why<a hidden class="anchor" aria-hidden="true" href="#why">#</a></h2>
<p>Since this is, sadly, something that needs to be done in order to score points in ctfs, I&rsquo;m going to cover some things that <em>I</em> feel  are important in this category.</p>
<p>I have done quite a few forensics challenges, but I never really mastered <code>grep</code> and <code>tshark</code> to their full potential. And I forgot most of my Wireshark expertise from last year, so I&rsquo;ll include what I feel is important or non-intuitive about that as well.</p>
<hr>
<p>I&rsquo;m writing this as I learn, so keep that in mind.</p>
<h2 id="grep">Grep<a hidden class="anchor" aria-hidden="true" href="#grep">#</a></h2>
<p>Feel free to skip this if you already know your stuff with grep. I for one always avoided learning this in depth, so that&rsquo;s what I&rsquo;ll be doing now.</p>
<p>We all know the basic syntax, <code>grep &quot;string&quot; /path/file</code>. There is also the color-text-in-file <code>--color</code> parameter.</p>
<p>To ignore case sensitivity, just add an <code>-i</code> before the string.</p>
<p>To just count the lines in which the text appears, <code>-c</code>. If you want to see them <em>and</em> number them, use <code>-n</code>.</p>
<p>To invert the grep output, add a <code>-v</code>; this means print all the lines that <em>don&rsquo;t</em> contain the expression.</p>
<p>For an exact word, use <code>-w</code>, meaning it won&rsquo;t print a word if it&rsquo;s a suffix/prefix.</p>
<p>If we only want the matches, and not the lines, add an <code>-o</code>.</p>
<p>Obviously the most useful grep is, is as a pipe. So if we want to see if openSSH has been installed on our system, we can just do <code>dpkg -L | grep -i &quot;openssh&quot;</code>.</p>
<p>The <code>-A 4</code> will print the line with our string and then 4 more lines coming after, and <code>-B 4</code> the string and its 4 preceding lines (you know, after, before..).</p>
<p>Now time for REGEX (REGular EXpressions)! A REGEX is a sequence of characters that is used to match a pattern.</p>
<p>To search for an expression, we add an <code>-E</code> (for example, looking for <code>first|second</code>, looking for either words).</p>
<p>The <code>^ </code> and <code> $</code> are used as anchors; <code>^c</code> means line begins with <code>c</code>, and <code>c$</code> means line ends with <code>c</code>.</p>
<p>The dot <code>.</code> is a one character wildcard, meaning any character. If you mean the <em>actual</em> dot, escape by using a <code>\</code> like <code>\.</code>.</p>
<p>The full wildcard is <code>*</code>, can also be used for files, like <code>*.txt</code> means look in all files with that extension.</p>
<p>If instead of a wildcard, we mean to search a certain range, we use the <code>[..]</code> syntax. An example is <code>grep -w '[sS]ample[0-9]' file</code>. We can also use <code>[A-Za-z]</code> for letters. If we want to <em>negate</em> a range, we can use a <code>^</code> as in <code>[^0-9]</code>.</p>
<p>If we want an AND, we just pipe the output through another grep.</p>
<p>We can also test how many times a character must be repeated in a sequence, with <code>{N}</code>. This can also be a range, like <code>{min,max}</code>. For example, to match both <em>col</em> and <em>cool</em>, we can use <code>grep -E 'co{1,2}l' file</code>. If we don&rsquo;t specify a maximum, like <code>{N,}</code>, it means <em>at least</em> N characters.</p>
<p>A useful source I used was <a href="https://www.cyberciti.biz/faq/grep-regular-expressions/">this</a>.</p>
<h2 id="sort">Sort<a hidden class="anchor" aria-hidden="true" href="#sort">#</a></h2>
<p>Now a word about using <code>sort</code> because I came across this in a challenge and had to resort to ChatGPT to do it, and we can&rsquo;t have that. Just using <code>sort filename</code> sorts the lines alphabetically.</p>
<p>Now let&rsquo;s look at the flags. <code>-r</code> for reverse order, <code>-n</code> to sort numerically, <code>k</code> to sort based on a specific column number, <code>-u</code> to remove duplicates.</p>
<p><code>-t</code> specifies a delimiter for fields, which if unspecified, is automatically space. And <code>-k1</code> means from field 1 to end of line while <code>-k1,1</code> means to only use that one field.</p>
<h1 id="sed">Sed<a hidden class="anchor" aria-hidden="true" href="#sed">#</a></h1>
<p>Turns out <code>sed</code> (stream editor) is quite important as well. The source I&rsquo;ll be referencing is <a href="https://dev.to/eshanized/mastering-sed-commands-and-flags-a-guide-to-stream-editing-in-linux-29jj">here</a>.</p>
<ol>
<li><strong>Substitution</strong>: <code>sed 's/pattern/replacement/flags' file</code> - Replace the first occurrence of pattern with replacement. Some flags are:</li>
</ol>
<ul>
<li>
<p><code>sed 's/foo/bar/g' file.txt</code> for global substitution (all of them);</p>
</li>
<li>
<p><code>sed 's/foo/bar/i' file.txt</code> is case insensitive search;</p>
</li>
<li>
<p><code>sed 's/foo/bar/2 file.txt</code> replaces the n-th occurrence of foo with bar (in this case, 2).</p>
</li>
</ul>
<ol start="2">
<li><strong>Deletion</strong>: <code>sed '/pattern/d' file</code>.</li>
</ol>
<ul>
<li>
<p>To delete blank lines for example, we can do <code>sed '/^$/d' file.txt</code>.</p>
</li>
<li>
<p>To delete all lines starting with a digit, just like grep, <code>sed '/^[0-9]/d' file.txt</code>.</p>
</li>
</ul>
<ol start="3">
<li><strong>Printing</strong>: We can print lines matching a pattern, often with <code>-n</code> as a flag to suppress the normal behaviour of sed which just prints everything: <code>sed -n '/pattern/p' file</code>.</li>
</ol>
<ul>
<li>To print matching lines with the next line, <code>sed -n '/error/{N; p}' file.txt</code>. This prints lines containing error along with the following lines.</li>
</ul>
<ol start="4">
<li><strong>Insertion</strong>, to add a line before the pattern-found-line: <code>sed 'line_number i\text_to_insert' file</code>.</li>
</ol>
<ul>
<li>
<p>To insert text before a specific line, <code>sed '2i\I'm inserted before line 2' file</code>.</p>
</li>
<li>
<p>To insert text before a specific pattern, <code>sed '/error/i\Next is an error message.'</code></p>
</li>
</ul>
<ol start="5">
<li><strong>Appending</strong>: Just like insert, but it&rsquo;s just after: <code>sed 'line_number a\text_to_append' file</code>.</li>
</ol>
<ul>
<li>
<p>To append text after a specific line, <code>sed '2a\I'm after line 2' file.txt</code>.</p>
</li>
<li>
<p>To append text after a specific pattern, <code>sed '/error/a\I'm after an error' file.txt</code>.</p>
</li>
</ul>
<ol start="6">
<li><strong>Change</strong>: Just modify the entire content of a line with new text: <code>sed 'line number c\new_text' file</code>.</li>
</ol>
<ul>
<li>
<p>To change the content of a certain line: <code>sed '2c\Now I am line 2' file</code>.</p>
</li>
<li>
<p>To replace all matching lines of a pattern: <code>sed '/error/c\Critical Error' file.txt</code>. This replaces all lines containing error to Critical Error.</p>
</li>
</ul>
<ol start="7">
<li><strong>Ranges</strong>: We can apply sed to a range of lines, too: <code>sed 'start_line, end_line command' file</code>.</li>
</ol>
<ul>
<li>
<p>For example, to delete lines 2 to 4: <code>sed '2,4d' file</code>.</p>
</li>
<li>
<p>To delete text between the first two occurrences of patterns: <code>sed '/start/,/end/d</code> - removes all text between and including the first start and end.</p>
</li>
</ul>
<hr>
<p>We can chain multiple commands, sequentially, using <code>-e</code>. And as I meantioned, by default, sed prints every line, and the <code>-n</code> flag blocks this. The <code>-i</code> flag enables in-place editing aka it modifies the file directly; otherwise, it needs redirection, it doesn&rsquo;t actually modify our file. And of course like grep, to use RegEx, we need to add the <code>-E</code> flag. And to escape special characters of course we use <code>\</code>.</p>
<h2 id="find">Find<a hidden class="anchor" aria-hidden="true" href="#find">#</a></h2>
<p>Also a useful command in some challs was <code>find</code>, to search system-wide for files containing &ldquo;ctf&rdquo; like <code>sudo find / -type f -exec grep -l &quot;ctf&quot; {} + 2&gt;/dev/null</code>. Or maybe like <code>grep -RIl &quot;ctf&quot; / 2&gt;/dev/null</code>.</p>
<h2 id="wireshark">Wireshark<a hidden class="anchor" aria-hidden="true" href="#wireshark">#</a></h2>
<p>Now that we have a basic understanding of grep, before we get to the more intimidating tshark, let&rsquo;s note a few things about Wireshark. <a href="https://book.jorianwoltjer.com/forensics/wireshark">Source</a> if you don&rsquo;t like how I said it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>tcp.port <span style="color:#f92672">==</span> <span style="color:#ae81ff">4444</span>  <span style="color:#75715e"># Match TCP port</span>
</span></span><span style="display:flex;"><span>ip.addr !<span style="color:#f92672">=</span> 10.10.10.10  <span style="color:#75715e"># Filter out source or destination IP address</span>
</span></span><span style="display:flex;"><span>eth.addr <span style="color:#f92672">==</span> 00:00:5e:00:53:00  <span style="color:#75715e"># Filter Ethernet MAC address</span>
</span></span><span style="display:flex;"><span>http  <span style="color:#75715e"># Filter only http traffic</span>
</span></span><span style="display:flex;"><span>http.host contains <span style="color:#e6db74">&#34;example&#34;</span>  <span style="color:#75715e"># Filter HTTP host header containing string</span>
</span></span><span style="display:flex;"><span>pkt_comment  <span style="color:#75715e"># Filter on Wireshark comments in the capture</span>
</span></span></code></pre></div><p>We can use <code>||</code> <code>&amp;&amp;</code> <code>==</code> and <code>!=</code> normally.</p>
<p>The most important filters are:</p>
<ul>
<li>
<p><code>tcp</code> (inlcudes http). We can follow streams (formed by multiple packets).</p>
</li>
<li>
<p><code>http</code> which is self explanatory, isn&rsquo;t it? To download files sent over http, we can look at <code>File -&gt; Export Objects -&gt; HTTP</code> to view all objects and download what we like.</p>
</li>
<li>
<p><code>dns</code></p>
</li>
<li>
<p><code>USB Keystrokes</code>, like a USB keyboard for example, sending a lot of <code>URB_INTERRUPT in</code> packets.</p>
</li>
<li>
<p><code>SSL/TLS</code> (transfer layer security, so https) means we need a RSA key to decrypt the data. We can go to <code>Edit -&gt; Preferences -&gt; Protocols -&gt; TLS</code> and add an entry with the IP and port of target, the http protocol and the path to the file containing the key.</p>
</li>
</ul>
<h2 id="tshark">tshark<a hidden class="anchor" aria-hidden="true" href="#tshark">#</a></h2>
<p>Terminal wireshark. Useful for extracting stuff quickly. This is how our parameters will look like:</p>
<ul>
<li>
<p><code>-r</code> - .pcap to read from</p>
</li>
<li>
<p><code>-Y [filter]</code> - filters to apply</p>
</li>
<li>
<p><code>-T fields</code> - display only selected fields</p>
</li>
<li>
<p><code>-e [field]</code> - field name to display</p>
</li>
</ul>
<p>We can view the field name clicking on it in Wireshark. I really did think this would be more complicated, but that&rsquo;s kind of it.</p>
<p>I made a challenge to demo my new knowledges <a href="">here</a>, so you can take a look at that if you want.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/materials/">Materials</a></li>
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/web/">Web</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="https://irinasusca.github.io/writeup-blog/">Irina&#39;s CTF Writeups</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
