<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>CyberEdu ast-tree Writeup | Irina&#39;s CTF Writeups</title>
<meta name="keywords" content="CyberEdu, misc">
<meta name="description" content="Challenge overview
A careless developer left behind some code that reads sensitive files directly from disk.

We&rsquo;re prompted with a &ldquo;Paste your AST-Grep YAML rule here&rdquo; and an option to run it. ast-grep is a code tool for structural search and replace, like syntax-aware grep.
We can also use jQuery like utility methods to traverse syntax tree nodes.
Identifying the vulnerabilities
Upon entering an invalid file, we get this ChatGPT written error:">
<meta name="author" content="">
<link rel="canonical" href="https://irinasusca.github.io/writeup-blog/posts/asttree-writeup/">
<link crossorigin="anonymous" href="/writeup-blog/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css" integrity="sha256-NDzEgLn/yPBMy&#43;XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://irinasusca.github.io/writeup-blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://irinasusca.github.io/writeup-blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://irinasusca.github.io/writeup-blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://irinasusca.github.io/writeup-blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://irinasusca.github.io/writeup-blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://irinasusca.github.io/writeup-blog/posts/asttree-writeup/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="https://irinasusca.github.io/writeup-blog/posts/asttree-writeup/">
  <meta property="og:site_name" content="Irina&#39;s CTF Writeups">
  <meta property="og:title" content="CyberEdu ast-tree Writeup">
  <meta property="og:description" content="Challenge overview A careless developer left behind some code that reads sensitive files directly from disk.
We‚Äôre prompted with a ‚ÄúPaste your AST-Grep YAML rule here‚Äù and an option to run it. ast-grep is a code tool for structural search and replace, like syntax-aware grep.
We can also use jQuery like utility methods to traverse syntax tree nodes.
Identifying the vulnerabilities Upon entering an invalid file, we get this ChatGPT written error:">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2026-01-29T00:00:00+00:00">
    <meta property="article:modified_time" content="2026-01-29T00:00:00+00:00">
    <meta property="article:tag" content="CyberEdu">
    <meta property="article:tag" content="Misc">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CyberEdu ast-tree Writeup">
<meta name="twitter:description" content="Challenge overview
A careless developer left behind some code that reads sensitive files directly from disk.

We&rsquo;re prompted with a &ldquo;Paste your AST-Grep YAML rule here&rdquo; and an option to run it. ast-grep is a code tool for structural search and replace, like syntax-aware grep.
We can also use jQuery like utility methods to traverse syntax tree nodes.
Identifying the vulnerabilities
Upon entering an invalid file, we get this ChatGPT written error:">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://irinasusca.github.io/writeup-blog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "CyberEdu ast-tree Writeup",
      "item": "https://irinasusca.github.io/writeup-blog/posts/asttree-writeup/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CyberEdu ast-tree Writeup",
  "name": "CyberEdu ast-tree Writeup",
  "description": "Challenge overview A careless developer left behind some code that reads sensitive files directly from disk.\nWe\u0026rsquo;re prompted with a \u0026ldquo;Paste your AST-Grep YAML rule here\u0026rdquo; and an option to run it. ast-grep is a code tool for structural search and replace, like syntax-aware grep.\nWe can also use jQuery like utility methods to traverse syntax tree nodes.\nIdentifying the vulnerabilities Upon entering an invalid file, we get this ChatGPT written error:\n",
  "keywords": [
    "CyberEdu", "misc"
  ],
  "articleBody": "Challenge overview A careless developer left behind some code that reads sensitive files directly from disk.\nWe‚Äôre prompted with a ‚ÄúPaste your AST-Grep YAML rule here‚Äù and an option to run it. ast-grep is a code tool for structural search and replace, like syntax-aware grep.\nWe can also use jQuery like utility methods to traverse syntax tree nodes.\nIdentifying the vulnerabilities Upon entering an invalid file, we get this ChatGPT written error:\n‚úÖ Output: Error: Cannot parse rule /tmp/psu6fojepi.yaml Help: The file is not a valid ast-grep rule. Please refer to doc and fix the error. See also: https://ast-grep.github.io/guide/rule-config.html ‚úñ Caused by ‚ï∞‚ñª Fail to parse yaml as RuleConfig ‚ï∞‚ñª invalid type: string \"node napi.js\", expected struct SerializableRuleConfig Trying grep flag, we get üö´ Blacklisted keyword \"flag\" detected!.\nThey even give us the docs, can it get easier than this?!\nThe format of a rule looks something like this:\nid: no-await-in-promise-all language: TypeScript rule: pattern: Promise.all($A) has: pattern: await $_ stopBy: end I told myself I won‚Äôt be using ChatGPT anymore since OSC is interdicting it, so I actually read docs and Stack Overflow questions for this.\nSo we can find a string through the regex instead of pattern (search for the actual string through rust‚Äôs regex finder), but we need to specify the kind, which was string in this case. Adding the all specifier for rule was what made it work, finally. And I looped through some languages, and js was the winner in this case.\nAnyway, here‚Äôs the full rule and the flag:\n",
  "wordCount" : "255",
  "inLanguage": "en",
  "datePublished": "2026-01-29T00:00:00Z",
  "dateModified": "2026-01-29T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://irinasusca.github.io/writeup-blog/posts/asttree-writeup/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Irina's CTF Writeups",
    "logo": {
      "@type": "ImageObject",
      "url": "https://irinasusca.github.io/writeup-blog/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://irinasusca.github.io/writeup-blog/" accesskey="h" title="Irina&#39;s CTF Writeups (Alt + H)">Irina&#39;s CTF Writeups</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      CyberEdu ast-tree Writeup
    </h1>
    <div class="post-meta"><span title='2026-01-29 00:00:00 +0000 UTC'>January 29, 2026</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#challenge-overview" aria-label="Challenge overview">Challenge overview</a></li>
                <li>
                    <a href="#identifying-the-vulnerabilities" aria-label="Identifying the vulnerabilities">Identifying the vulnerabilities</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="challenge-overview">Challenge overview<a hidden class="anchor" aria-hidden="true" href="#challenge-overview">#</a></h2>
<p>A careless developer left behind some code that reads sensitive files directly from disk.</p>
<hr>
<p>We&rsquo;re prompted with a &ldquo;Paste your AST-Grep YAML rule here&rdquo; and an option to run it. <code>ast-grep</code> is a code tool for structural search and replace, like syntax-aware grep.</p>
<p>We can also use jQuery like utility methods to traverse syntax tree nodes.</p>
<h2 id="identifying-the-vulnerabilities">Identifying the vulnerabilities<a hidden class="anchor" aria-hidden="true" href="#identifying-the-vulnerabilities">#</a></h2>
<p>Upon entering an invalid file, we get this ChatGPT written error:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>‚úÖ Output:
</span></span><span style="display:flex;"><span>Error: Cannot parse rule /tmp/psu6fojepi.yaml
</span></span><span style="display:flex;"><span>Help: The file is not a valid ast-grep rule. Please refer to doc and fix the error.
</span></span><span style="display:flex;"><span>See also: https://ast-grep.github.io/guide/rule-config.html
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>‚úñ Caused by
</span></span><span style="display:flex;"><span>‚ï∞‚ñª Fail to parse yaml as RuleConfig
</span></span><span style="display:flex;"><span>‚ï∞‚ñª invalid type: string <span style="color:#e6db74">&#34;node napi.js&#34;</span>, expected struct SerializableRuleConfig
</span></span></code></pre></div><p>Trying <code>grep flag</code>, we get <code>üö´ Blacklisted keyword &quot;flag&quot; detected!</code>.</p>
<p>They even give us the docs, can it get easier than this?!</p>
<p>The format of a rule looks something like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>id: no-await-in-promise-all
</span></span><span style="display:flex;"><span>language: TypeScript
</span></span><span style="display:flex;"><span>rule:
</span></span><span style="display:flex;"><span>  pattern: Promise.all<span style="color:#f92672">(</span>$A<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  has:
</span></span><span style="display:flex;"><span>    pattern: await $_
</span></span><span style="display:flex;"><span>    stopBy: end
</span></span></code></pre></div><p>I told myself I won&rsquo;t be using ChatGPT anymore since OSC is interdicting it, so I actually read docs and Stack Overflow questions for this.</p>
<p>So we can find a string through the <code>regex</code> instead of <code>pattern</code> (search for the actual string through rust&rsquo;s regex finder), but we need to specify the <code>kind</code>, which was <code>string</code> in this case. Adding the <code>all</code> specifier for <code>rule</code> was what made it work, finally. And I looped through some languages, and js was the winner in this case.</p>
<p>Anyway, here&rsquo;s the full rule and the flag:</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/asttree-writeup/flag.png#center"></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/cyberedu/">CyberEdu</a></li>
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/misc/">Misc</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="https://irinasusca.github.io/writeup-blog/">Irina&#39;s CTF Writeups</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
