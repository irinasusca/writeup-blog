<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>CyberEdu offensive-honeypot Writeup | Irina&#39;s CTF Writeups</title>
<meta name="keywords" content="CyberEdu, pwn, Random">
<meta name="description" content="Challenge overview
Just another pwn challenge.

We&rsquo;re dealing with a little game, and a canary.

The win condition is that we beat the game, by killing the hacker player.

Identifying the vulnerabilities

The vulnerability here is that we can calculate the random number ourselves, very similarly to another challenge I wrote the writeup for here.
Since we know the seed ourselves, we can get the same value for rand() that the game gets.">
<meta name="author" content="">
<link rel="canonical" href="https://irinasusca.github.io/writeup-blog/posts/offensivehoneypot-writeup/">
<link crossorigin="anonymous" href="/writeup-blog/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css" integrity="sha256-NDzEgLn/yPBMy&#43;XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://irinasusca.github.io/writeup-blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://irinasusca.github.io/writeup-blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://irinasusca.github.io/writeup-blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://irinasusca.github.io/writeup-blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://irinasusca.github.io/writeup-blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://irinasusca.github.io/writeup-blog/posts/offensivehoneypot-writeup/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="https://irinasusca.github.io/writeup-blog/posts/offensivehoneypot-writeup/">
  <meta property="og:site_name" content="Irina&#39;s CTF Writeups">
  <meta property="og:title" content="CyberEdu offensive-honeypot Writeup">
  <meta property="og:description" content="Challenge overview Just another pwn challenge.
We’re dealing with a little game, and a canary.
The win condition is that we beat the game, by killing the hacker player.
Identifying the vulnerabilities The vulnerability here is that we can calculate the random number ourselves, very similarly to another challenge I wrote the writeup for here.
Since we know the seed ourselves, we can get the same value for rand() that the game gets.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-12-28T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-12-28T00:00:00+00:00">
    <meta property="article:tag" content="CyberEdu">
    <meta property="article:tag" content="Pwn">
    <meta property="article:tag" content="Random">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CyberEdu offensive-honeypot Writeup">
<meta name="twitter:description" content="Challenge overview
Just another pwn challenge.

We&rsquo;re dealing with a little game, and a canary.

The win condition is that we beat the game, by killing the hacker player.

Identifying the vulnerabilities

The vulnerability here is that we can calculate the random number ourselves, very similarly to another challenge I wrote the writeup for here.
Since we know the seed ourselves, we can get the same value for rand() that the game gets.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://irinasusca.github.io/writeup-blog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "CyberEdu offensive-honeypot Writeup",
      "item": "https://irinasusca.github.io/writeup-blog/posts/offensivehoneypot-writeup/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CyberEdu offensive-honeypot Writeup",
  "name": "CyberEdu offensive-honeypot Writeup",
  "description": "Challenge overview Just another pwn challenge.\nWe\u0026rsquo;re dealing with a little game, and a canary.\nThe win condition is that we beat the game, by killing the hacker player.\nIdentifying the vulnerabilities The vulnerability here is that we can calculate the random number ourselves, very similarly to another challenge I wrote the writeup for here.\nSince we know the seed ourselves, we can get the same value for rand() that the game gets.\n",
  "keywords": [
    "CyberEdu", "pwn", "Random"
  ],
  "articleBody": "Challenge overview Just another pwn challenge.\nWe’re dealing with a little game, and a canary.\nThe win condition is that we beat the game, by killing the hacker player.\nIdentifying the vulnerabilities The vulnerability here is that we can calculate the random number ourselves, very similarly to another challenge I wrote the writeup for here.\nSince we know the seed ourselves, we can get the same value for rand() that the game gets.\nThere are three functions that make the player take damage (0 to 1000 hp) and three functions that make the hacker take damage (0 to 30). The player_hurt() functions are called during incoming attacks, if we don’t pick the correct defense (which we can predict, but more on that later).\nThehacker_hurt() functions are called in start_routine():\nAnother thing I noticed is that the hacker doesn’t take any damage if we don’t use menu option 2 (change defense) before option 3 (catch attacks) even though catch attacks calls change defense. This is because of the order that things are done - before incoming attack is called, the start_routine is called through the new thread, and current_defense isn’t set yet, it’s just -1, and it needs to be a positive/chosen value for hacker to take damage.\nSo we need to use option 2 of the menu as well. Since if current_defense is 1 when start_routine is called, the hacker takes the highest amount of damage (rand()%30 instead of 3 or 4), we’ll set our defense to 1 initially.\nThen, we call option 3, and change our defense back to a proper and calculated defense (get it, because it’s literally calculated, haha).\nSo, if we can just guess that random number, we can always put the right defense on, and just beat the game in less than 200 rounds (Game over).\nI set a breakpoint at the first rand() call, and looked at the rax to detect the proper seed for the local binary (it will most certainly differ remotely, because connection takes longer). Sometimes it was the value at i=10, other times at i=11.\n#c code libc = CDLL(\"/lib/x86_64-linux-gnu/libc.so.6\") now = int(time.time()) i=10 j=1 for seed in range(now - 10, now + 10): libc.srand(seed) random = libc.rand() print(seed, random) if i==j: random_number = random j=j+1 print(f\"random number for i={i} is {random_number}\") The exploit Alright, we got the number, and now essentially the flow we want is this:\nPick option 2\nMake current defense 1\nCreate a defense variable ourselves, libc.rand() \u0026 3, equal to their one\nMake current defense the defense variable\nRepeat\nKeep in mind, the first iteration we use the first random_number, the one calculated above.\nThis logic seemed great, but now the random number just stopped matching up. The reason why is because the damage dealt to the hacked with rand()%30 also calls rand, so we also need to call rand() in our code every time the hacker takes damage.\nAnd another thing, we need to update the seed, because it would always end up as the last seed tried in the loop (now + whatever), which isn’t what we want (now + i).\nI made the specified modifications, I ran the script about four times, it failed, but the fifth time, it worked!\n#c code libc = CDLL(\"/lib/x86_64-linux-gnu/libc.so.6\") now = int(time.time()) i=10 j=1 for seed in range(now - 10, now + 10): libc.srand(seed) random = libc.rand() print(seed, random) if i==j: random_number = random random_seed = seed j=j+1 #save the seed at now + i libc.srand(random_seed) random_number = libc.rand() print(f\"random number for i={i} is {random_number}\") #send name p.recvuntil(b\"name?\\n\") p.sendline(b\"fufu\") p.recvuntil(b\"option:\") p.sendline(b\"2\") p.recvuntil(b\"Option: \") p.sendline(b\"1\") print(f\"hacker number is {random_number}\") #hacker takes damage, so rand() is called, let's keep up; #the first time, we don't call rand() for this #because we already called it once for our seed p.recvuntil(b\"option:\") p.sendline(b\"3\") random_number = libc.rand() print(f\"player number is {random_number}\") defense = random_number \u0026 3 p.recvuntil(b\"Option: \") p.sendline(str(defense).encode()) #now we can start a loop while True: #go forth with our thing try: p.recvuntil(b\"option:\", timeout=0.5) p.sendline(b\"2\") p.recvuntil(b\"Option: \") p.sendline(b\"1\") #hacker takes damage here, rand() called hacker = libc.rand() print(f\"hacker number is {hacker}\") random_number = libc.rand() print(f\"player number is {random_number}\") defense = random_number \u0026 3 p.recvuntil(b\"option:\") p.sendline(b\"3\") p.recvuntil(b\"Option: \") p.sendline(str(defense).encode()) buf = b\"\" # reset after handling continue # if the program printed something else (flag hopefully) and stopped prompting except: break p.interactive() I modified my i to 11 and we easily get the flag remotely, as well!\nAs always, the full code can be found on my GitHub here.\n",
  "wordCount" : "747",
  "inLanguage": "en",
  "datePublished": "2025-12-28T00:00:00Z",
  "dateModified": "2025-12-28T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://irinasusca.github.io/writeup-blog/posts/offensivehoneypot-writeup/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Irina's CTF Writeups",
    "logo": {
      "@type": "ImageObject",
      "url": "https://irinasusca.github.io/writeup-blog/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://irinasusca.github.io/writeup-blog/" accesskey="h" title="Irina&#39;s CTF Writeups (Alt + H)">Irina&#39;s CTF Writeups</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      CyberEdu offensive-honeypot Writeup
    </h1>
    <div class="post-meta"><span title='2025-12-28 00:00:00 +0000 UTC'>December 28, 2025</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#challenge-overview" aria-label="Challenge overview">Challenge overview</a></li>
                <li>
                    <a href="#identifying-the-vulnerabilities" aria-label="Identifying the vulnerabilities">Identifying the vulnerabilities</a></li>
                <li>
                    <a href="#the-exploit" aria-label="The exploit">The exploit</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="challenge-overview">Challenge overview<a hidden class="anchor" aria-hidden="true" href="#challenge-overview">#</a></h2>
<p>Just another <strong><a href="https://app.cyber-edu.co/challenges/559cb970-7f21-11ea-a99e-2f006e8673c3?tenant=cyberedu">pwn challenge</a></strong>.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/offensivehoneypot-writeup/pic1.png#center"></p>
<p>We&rsquo;re dealing with a little game, and a canary.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/offensivehoneypot-writeup/pic2.png#center"></p>
<p>The win condition is that we beat the game, by killing the <em>hacker</em> player.</p>
<hr>
<h2 id="identifying-the-vulnerabilities">Identifying the vulnerabilities<a hidden class="anchor" aria-hidden="true" href="#identifying-the-vulnerabilities">#</a></h2>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/offensivehoneypot-writeup/pic3.png#center"></p>
<p>The vulnerability here is that we can calculate the <em>random</em> number ourselves, very similarly to another challenge I wrote the writeup for <strong><a href="https://irinasusca.github.io/writeup-blog/posts/babyfmt-writeup/">here</a></strong>.</p>
<p>Since we know the seed ourselves, we can get the same value for <code>rand()</code> that the game gets.</p>
<p>There are three functions that make the player take damage (0 to 1000 hp) and three functions that make the hacker take damage (0 to 30). The <code>player_hurt()</code> functions are called during incoming attacks, if we don&rsquo;t pick the correct defense (which we can predict, but more on that later).</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/offensivehoneypot-writeup/pic4.png#center"></p>
<p>The<code>hacker_hurt()</code> functions are called in <code>start_routine()</code>:</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/offensivehoneypot-writeup/pic5.png#center"></p>
<p>Another thing I noticed is that the hacker doesn&rsquo;t take any damage if we don&rsquo;t use menu option 2 (change defense) before option 3 (catch attacks) even though catch attacks calls change defense. This is because of the order that things are done - before incoming attack is called, the <code>start_routine</code> is called through the new thread, and <code>current_defense</code> isn&rsquo;t set yet, it&rsquo;s just <code>-1</code>, and it needs to be a positive/chosen value for hacker to take damage.</p>
<p>So we need to use option 2 of the menu as well. Since if <code>current_defense</code> is <code>1</code> when <code>start_routine</code> is called, the hacker takes the highest amount of damage (<code>rand()%30</code> instead of 3 or 4), we&rsquo;ll set our defense to <code>1</code> initially.</p>
<p>Then, we call option 3, and change our defense back to a proper and calculated defense (<em>get it, because it&rsquo;s literally calculated, haha</em>).</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/offensivehoneypot-writeup/pic6.png#center"></p>
<p>So, if we can just guess that random number, we can always put the right defense on, and just beat the game in less than 200 rounds (Game over).</p>
<p>I set a breakpoint at the first <code>rand()</code> call, and looked at the <code>rax</code> to detect the proper seed for the local binary (it will most certainly differ remotely, because connection takes longer). Sometimes it was the value at <code>i=10</code>, other times at <code>i=11</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#c code</span>
</span></span><span style="display:flex;"><span>libc <span style="color:#f92672">=</span> CDLL(<span style="color:#e6db74">&#34;/lib/x86_64-linux-gnu/libc.so.6&#34;</span>)
</span></span><span style="display:flex;"><span>now <span style="color:#f92672">=</span> int(time<span style="color:#f92672">.</span>time())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>i<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>j<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> seed <span style="color:#f92672">in</span> range(now <span style="color:#f92672">-</span> <span style="color:#ae81ff">10</span>, now <span style="color:#f92672">+</span> <span style="color:#ae81ff">10</span>):
</span></span><span style="display:flex;"><span>    libc<span style="color:#f92672">.</span>srand(seed)
</span></span><span style="display:flex;"><span>    random <span style="color:#f92672">=</span> libc<span style="color:#f92672">.</span>rand()
</span></span><span style="display:flex;"><span>    print(seed, random)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> i<span style="color:#f92672">==</span>j:
</span></span><span style="display:flex;"><span>    	random_number <span style="color:#f92672">=</span> random
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    j<span style="color:#f92672">=</span>j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;random number for i=</span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74"> is </span><span style="color:#e6db74">{</span>random_number<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/offensivehoneypot-writeup/pic7.png#center"></p>
<hr>
<h2 id="the-exploit">The exploit<a hidden class="anchor" aria-hidden="true" href="#the-exploit">#</a></h2>
<p>Alright, we got the number, and now essentially the flow we want is this:</p>
<ul>
<li>
<p>Pick option 2</p>
</li>
<li>
<p>Make current defense 1</p>
</li>
<li>
<p>Create a defense variable ourselves, <code>libc.rand() &amp; 3</code>, equal to their one</p>
</li>
<li>
<p>Make current defense the defense variable</p>
</li>
<li>
<p>Repeat</p>
</li>
</ul>
<p>Keep in mind, the first iteration we use the first <code>random_number</code>, the one calculated above.</p>
<p>This logic <em>seemed</em> great, but now the random number just stopped matching up. The reason why is because the damage dealt to the hacked with <code>rand()%30</code> also calls <code>rand</code>, so we also need to call <code>rand()</code> in our code every time the hacker takes damage.</p>
<p>And another thing, we need to update the <code>seed</code>, because it would always end up as the last seed tried in the loop (<code>now + whatever</code>), which isn&rsquo;t what we want (<code>now + i</code>).</p>
<p>I made the specified modifications, I ran the script about four times, it failed, but the fifth time, it worked!</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/offensivehoneypot-writeup/pic8.png#center"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#c code</span>
</span></span><span style="display:flex;"><span>libc <span style="color:#f92672">=</span> CDLL(<span style="color:#e6db74">&#34;/lib/x86_64-linux-gnu/libc.so.6&#34;</span>)
</span></span><span style="display:flex;"><span>now <span style="color:#f92672">=</span> int(time<span style="color:#f92672">.</span>time())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>i<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>j<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> seed <span style="color:#f92672">in</span> range(now <span style="color:#f92672">-</span> <span style="color:#ae81ff">10</span>, now <span style="color:#f92672">+</span> <span style="color:#ae81ff">10</span>):
</span></span><span style="display:flex;"><span>    libc<span style="color:#f92672">.</span>srand(seed)
</span></span><span style="display:flex;"><span>    random <span style="color:#f92672">=</span> libc<span style="color:#f92672">.</span>rand()
</span></span><span style="display:flex;"><span>    print(seed, random)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> i<span style="color:#f92672">==</span>j:
</span></span><span style="display:flex;"><span>    	random_number <span style="color:#f92672">=</span> random
</span></span><span style="display:flex;"><span>    	random_seed <span style="color:#f92672">=</span> seed
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    j<span style="color:#f92672">=</span>j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#75715e">#save the seed at now + i</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>libc<span style="color:#f92672">.</span>srand(random_seed)
</span></span><span style="display:flex;"><span>random_number <span style="color:#f92672">=</span> libc<span style="color:#f92672">.</span>rand()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;random number for i=</span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74"> is </span><span style="color:#e6db74">{</span>random_number<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#send name</span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;name?</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;fufu&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;option:&#34;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;2&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Option: &#34;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;1&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;hacker number is </span><span style="color:#e6db74">{</span>random_number<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#hacker takes damage, so rand() is called, let&#39;s keep up;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#the first time, we don&#39;t call rand() for this </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#because we already called it once for our seed</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;option:&#34;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;3&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>random_number <span style="color:#f92672">=</span> libc<span style="color:#f92672">.</span>rand()
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;player number is </span><span style="color:#e6db74">{</span>random_number<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>defense <span style="color:#f92672">=</span> random_number <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Option: &#34;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendline(str(defense)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#now we can start a loop</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#go forth with our thing</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>: 
</span></span><span style="display:flex;"><span>        p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;option:&#34;</span>, timeout<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>        p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;2&#34;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Option: &#34;</span>)
</span></span><span style="display:flex;"><span>        p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;1&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#hacker takes damage here, rand() called</span>
</span></span><span style="display:flex;"><span>        hacker <span style="color:#f92672">=</span> libc<span style="color:#f92672">.</span>rand()
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;hacker number is </span><span style="color:#e6db74">{</span>hacker<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        random_number <span style="color:#f92672">=</span> libc<span style="color:#f92672">.</span>rand()
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;player number is </span><span style="color:#e6db74">{</span>random_number<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        defense <span style="color:#f92672">=</span> random_number <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;option:&#34;</span>)
</span></span><span style="display:flex;"><span>        p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;3&#34;</span>)
</span></span><span style="display:flex;"><span>        p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Option: &#34;</span>)
</span></span><span style="display:flex;"><span>        p<span style="color:#f92672">.</span>sendline(str(defense)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        buf <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&#34;</span>          <span style="color:#75715e"># reset after handling</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># if the program printed something else (flag hopefully) and stopped prompting</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><p>I modified my <code>i</code> to <code>11</code> and we easily get the flag remotely, as well!</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/offensivehoneypot-writeup/pic9.png#center"></p>
<hr>
<p>As always, the full code can be found on my GitHub
<strong><a href="https://github.com/irinasusca/ctf-writeups/blob/main/cyberedu/offensivehoneypot.py">here</a></strong>.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/cyberedu/">CyberEdu</a></li>
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/pwn/">Pwn</a></li>
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/random/">Random</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="https://irinasusca.github.io/writeup-blog/">Irina&#39;s CTF Writeups</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
