<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Pico Buffer Overflow 3 Writeup | Irina&#39;s CTF Writeups</title>
<meta name="keywords" content="picoCTF, pwn, buffer-overflow, canary">
<meta name="description" content="Challenge overview
Do you think you can bypass the protection and get the flag? It looks like Dr. Oswal added a stack canary to this program to protect against buffer overflows.

At first glance, the vuln looks like a 32-bit executable, probably with a buffer overflow vulnerability.
We are first prompted to create a canary.txt file, and the binary runs after that.

Analyzing the binary, first, the read_canary() function is called, and then we go into vuln.">
<meta name="author" content="">
<link rel="canonical" href="https://irinasusca.github.io/writeup-blog/posts/bufferoverflow3-writeup/">
<link crossorigin="anonymous" href="/writeup-blog/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css" integrity="sha256-NDzEgLn/yPBMy&#43;XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://irinasusca.github.io/writeup-blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://irinasusca.github.io/writeup-blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://irinasusca.github.io/writeup-blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://irinasusca.github.io/writeup-blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://irinasusca.github.io/writeup-blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://irinasusca.github.io/writeup-blog/posts/bufferoverflow3-writeup/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="https://irinasusca.github.io/writeup-blog/posts/bufferoverflow3-writeup/">
  <meta property="og:site_name" content="Irina&#39;s CTF Writeups">
  <meta property="og:title" content="Pico Buffer Overflow 3 Writeup">
  <meta property="og:description" content="Challenge overview Do you think you can bypass the protection and get the flag? It looks like Dr. Oswal added a stack canary to this program to protect against buffer overflows.
At first glance, the vuln looks like a 32-bit executable, probably with a buffer overflow vulnerability.
We are first prompted to create a canary.txt file, and the binary runs after that.
Analyzing the binary, first, the read_canary() function is called, and then we go into vuln.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-11-25T21:09:36+02:00">
    <meta property="article:modified_time" content="2025-11-25T21:09:36+02:00">
    <meta property="article:tag" content="PicoCTF">
    <meta property="article:tag" content="Pwn">
    <meta property="article:tag" content="Buffer-Overflow">
    <meta property="article:tag" content="Canary">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Pico Buffer Overflow 3 Writeup">
<meta name="twitter:description" content="Challenge overview
Do you think you can bypass the protection and get the flag? It looks like Dr. Oswal added a stack canary to this program to protect against buffer overflows.

At first glance, the vuln looks like a 32-bit executable, probably with a buffer overflow vulnerability.
We are first prompted to create a canary.txt file, and the binary runs after that.

Analyzing the binary, first, the read_canary() function is called, and then we go into vuln.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://irinasusca.github.io/writeup-blog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Pico Buffer Overflow 3 Writeup",
      "item": "https://irinasusca.github.io/writeup-blog/posts/bufferoverflow3-writeup/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Pico Buffer Overflow 3 Writeup",
  "name": "Pico Buffer Overflow 3 Writeup",
  "description": "Challenge overview Do you think you can bypass the protection and get the flag? It looks like Dr. Oswal added a stack canary to this program to protect against buffer overflows.\nAt first glance, the vuln looks like a 32-bit executable, probably with a buffer overflow vulnerability.\nWe are first prompted to create a canary.txt file, and the binary runs after that.\nAnalyzing the binary, first, the read_canary() function is called, and then we go into vuln.\n",
  "keywords": [
    "picoCTF", "pwn", "buffer-overflow", "canary"
  ],
  "articleBody": "Challenge overview Do you think you can bypass the protection and get the flag? It looks like Dr. Oswal added a stack canary to this program to protect against buffer overflows.\nAt first glance, the vuln looks like a 32-bit executable, probably with a buffer overflow vulnerability.\nWe are first prompted to create a canary.txt file, and the binary runs after that.\nAnalyzing the binary, first, the read_canary() function is called, and then we go into vuln.\nThere’s also a win function included in the binary, so we don’t have to worry about getting a shell ourselves.\nSo, firstly, the read_canary() reads four bytes from canary.txt.\nAfter renaming some of the variables from vuln, it starts looking like this:\nWe see the call to sscanf, and looking at the C documentation for it, what it does is it takes the input from v as an integer, and stores it in \u0026nbytes.\nThen, read(0, buf, nbytes) will read from the standard input (file descriptor 0), and write nbytesbytes from input intobuf`.\nAfter that, the binary checks if the canary has been modified.\nIdentifying the vulnerabilities Time for debugging with gef! I set a bp on the while(v_size \u003c= 63) just to check if we got anything wrong.\nLooks like our buffer overflow worked!\nFor the first input being 123 and the content being an ‘A’ buffer overflow, it sure does look like it worked!\nThe only issue is that the canary is also overwritten, so we need to take care of that now.\nThe global canary is saved in the .bss, and the stack canary is compared to that, to determine a whether stack smashing took place or not.\nThe canary example I chose is 0xebad3600, you can use zsh to write it into canary.txt like so:\necho -en '\\x00\\x36\\xad\\xeb' \u003e canary.txt Here it’s comparing the global canary to our stack canary which is currently overwritten by a bunch of ‘A’s.\nSince the canary is static, taken from a canary.txt file, we might be able to simply bruteforce it, byte by byte.\nThe offset from the beginning of our input buffer to the canary is 0x40, so 64 in decimal.\nThe Canary Considering the challenge hint is Maybe there’s a smart way to brute-force the canary?, I’m guessing there’s more to it than just bruteforcing it. The global canary is in a rw zone, so maybe we can overwrite it?\nBut since it’s 4 bytes, and most likely the last byte is null, we could just bruteforce it. There are 16,777,216 possible combinations with 3 bytes.\nBut if we test byte-by-byte, we can lower this number monumentally. So, I opted for creating a canary_bruteforce() function to help us find the correct canary.\nI’m not familiar with bruteforcing canaries so I looked online to see if I can find a script to help with this, but most of them didn’t work.\nIn the end, the most helpful source was this writeup. I made my own canary_bruteforce() with similar logic, but I always opt for using and sending bytes rather than strings.\ndef canary_bruteforce(): canary= b\"\" for i in range(1, 5): for c in range(256): p=elf.process() p.recvuntil(b'\u003e ') p.sendline(str(64+i)) p.recvuntil(b'\u003e ') payload = b\"A\"*64 + canary + bytes([c]) p.sendline(payload) result = p.recvall(timeout=0.2) if b\"Stack\" not in result: canary += bytes([c]) log.info(f\"[+] Found: {canary.hex()}\") p.close() break p.close() return canary Testing it locally, we leak our canary and get the flag!\nAll that’s left to do is connect remotely and see if we can extract the actual flag. The first time I tried, it didn’t work, so I ended up having to increase the timeout from 0.2 to 1, and instead of p.recvuntil, p.sendline I used p.sendlineafter, and that worked!\nAnd that’s it! The rest of the code can be found on my GitHub here.\n",
  "wordCount" : "630",
  "inLanguage": "en",
  "datePublished": "2025-11-25T21:09:36+02:00",
  "dateModified": "2025-11-25T21:09:36+02:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://irinasusca.github.io/writeup-blog/posts/bufferoverflow3-writeup/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Irina's CTF Writeups",
    "logo": {
      "@type": "ImageObject",
      "url": "https://irinasusca.github.io/writeup-blog/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://irinasusca.github.io/writeup-blog/" accesskey="h" title="Irina&#39;s CTF Writeups (Alt + H)">Irina&#39;s CTF Writeups</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Pico Buffer Overflow 3 Writeup
    </h1>
    <div class="post-meta"><span title='2025-11-25 21:09:36 +0200 EET'>November 25, 2025</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#challenge-overview" aria-label="Challenge overview">Challenge overview</a></li>
                <li>
                    <a href="#identifying-the-vulnerabilities" aria-label="Identifying the vulnerabilities">Identifying the vulnerabilities</a></li>
                <li>
                    <a href="#the-canary" aria-label="The Canary">The Canary</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="challenge-overview">Challenge overview<a hidden class="anchor" aria-hidden="true" href="#challenge-overview">#</a></h2>
<p>Do you think you can bypass the protection and get the flag? It looks like Dr. Oswal added a stack canary to <strong><a href="https://play.picoctf.org/practice/challenge/306">this program</a></strong> to protect against buffer overflows.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/bufferoverflow3-writeup/pic1.png#center"></p>
<p>At first glance, the <strong>vuln</strong> looks like a 32-bit executable, probably with a buffer overflow vulnerability.</p>
<p>We are first prompted to create a canary.txt file, and the binary runs after that.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/bufferoverflow3-writeup/pic2.png#center"></p>
<p>Analyzing the binary, first, the <code>read_canary()</code> function is called, and then we go into <code>vuln</code>.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/bufferoverflow3-writeup/pic3.png#center"></p>
<p>There&rsquo;s also a <code>win</code> function included in the binary, so we don&rsquo;t have to worry about getting a shell ourselves.</p>
<p>So, firstly, the <code>read_canary()</code> reads four bytes from canary.txt.</p>
<p>After renaming some of the variables from <code>vuln</code>, it starts looking like this:</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/bufferoverflow3-writeup/pic4.png#center"></p>
<p>We see the call to <code>sscanf</code>, and looking at the <strong><a href="https://www.tutorialspoint.com/c_standard_library/c_function_sscanf.htm">C documentation</a></strong> for it, what it does is it takes the input from <code>v</code> as an integer, and stores it in <code>&amp;nbytes</code>.</p>
<p>Then, <code>read(0, buf, nbytes) will read from the standard input (file descriptor 0), and write </code>nbytes<code>bytes from input into</code>buf`.</p>
<p>After that, the binary checks if the canary has been modified.</p>
<hr>
<h2 id="identifying-the-vulnerabilities">Identifying the vulnerabilities<a hidden class="anchor" aria-hidden="true" href="#identifying-the-vulnerabilities">#</a></h2>
<p>Time for debugging with <code>gef</code>! I set a bp on the <code>while(v_size &lt;= 63)</code> just to check if we got anything wrong.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/bufferoverflow3-writeup/pic5.png#center"></p>
<p>Looks like our buffer overflow worked!</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/bufferoverflow3-writeup/pic6.png#center"></p>
<p>For the first input being <code>123</code> and the content being an &lsquo;A&rsquo; buffer overflow, it sure does look like it worked!</p>
<p>The only issue is that the canary is also overwritten, so we need to take care of that now.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/bufferoverflow3-writeup/pic7.png#center"></p>
<p>The global canary is saved in the <code>.bss</code>, and the stack canary is compared to that, to determine a whether stack smashing took place or not.</p>
<p>The canary example I chose is <code>0xebad3600</code>, you can use zsh to write it into canary.txt like so:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>	echo <span style="color:#f92672">-</span>en <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x00\x36\xad\xeb</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">&gt;</span> canary<span style="color:#f92672">.</span>txt 
</span></span></code></pre></div><p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/bufferoverflow3-writeup/pic9.png#center"></p>
<p>Here it&rsquo;s comparing the global canary to our stack canary which is currently overwritten by a bunch of &lsquo;A&rsquo;s.</p>
<p>Since the canary is static, taken from a canary.txt file, we might be able to simply bruteforce it, byte by byte.</p>
<p>The offset from the beginning of our input buffer to the canary is <code>0x40</code>, so <code>64</code> in decimal.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/bufferoverflow3-writeup/pic10.png#center"></p>
<hr>
<h2 id="the-canary">The Canary<a hidden class="anchor" aria-hidden="true" href="#the-canary">#</a></h2>
<p>Considering the challenge hint is <em>Maybe there&rsquo;s a smart way to brute-force the canary?</em>, I&rsquo;m guessing there&rsquo;s more to it than just bruteforcing it.
The global canary is in a <code>rw</code> zone, so maybe we can overwrite it?</p>
<p>But since it&rsquo;s 4 bytes, and most likely the last byte is null, we could just bruteforce it. There are 16,777,216 possible combinations with 3 bytes.</p>
<p>But if we test byte-by-byte, we can lower this number monumentally.
So, I opted for creating a <code>canary_bruteforce()</code> function to help us find the correct canary.</p>
<p>I&rsquo;m not familiar with bruteforcing canaries so I looked online to see if I can find a script to help with this, but most of them didn&rsquo;t work.</p>
<p>In the end, the most helpful source was this <strong><a href="https://ctftime.org/writeup/32815">writeup</a></strong>. I made my own <code>canary_bruteforce()</code> with similar logic, but I always opt for using and sending bytes rather than strings.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">canary_bruteforce</span>():
</span></span><span style="display:flex;"><span>	canary<span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>):
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">256</span>):
</span></span><span style="display:flex;"><span>			p<span style="color:#f92672">=</span>elf<span style="color:#f92672">.</span>process()
</span></span><span style="display:flex;"><span>			p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&gt; &#39;</span>)
</span></span><span style="display:flex;"><span>			
</span></span><span style="display:flex;"><span>			p<span style="color:#f92672">.</span>sendline(str(<span style="color:#ae81ff">64</span><span style="color:#f92672">+</span>i))
</span></span><span style="display:flex;"><span>			p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&gt; &#39;</span>)
</span></span><span style="display:flex;"><span>			payload <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;A&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">64</span> <span style="color:#f92672">+</span> canary <span style="color:#f92672">+</span> bytes([c])
</span></span><span style="display:flex;"><span>			p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>			result <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recvall(timeout<span style="color:#f92672">=</span><span style="color:#ae81ff">0.2</span>)
</span></span><span style="display:flex;"><span>			
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">if</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Stack&#34;</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> result:
</span></span><span style="display:flex;"><span>				canary <span style="color:#f92672">+=</span> bytes([c])
</span></span><span style="display:flex;"><span>				log<span style="color:#f92672">.</span>info(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;[+] Found: </span><span style="color:#e6db74">{</span>canary<span style="color:#f92672">.</span>hex()<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>				p<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>			p<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> canary
</span></span></code></pre></div><p>Testing it locally, we leak our canary and get the flag!</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/bufferoverflow3-writeup/pic11.png#center"></p>
<p>All that&rsquo;s left to do is connect remotely and see if we can extract the actual flag.
The first time I tried, it didn&rsquo;t work, so I ended up having to increase the timeout from <code>0.2</code> to <code>1</code>, and instead of <code>p.recvuntil</code>, <code>p.sendline</code> I used <code>p.sendlineafter</code>, and that worked!</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/bufferoverflow3-writeup/pic12.png#center"></p>
<p>And that’s it! The rest of the code can be found on my GitHub
<strong><a href="https://github.com/irinasusca/ctf-writeups/blob/main/pico/bufferoverflow3.py">here</a></strong>.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/picoctf/">PicoCTF</a></li>
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/pwn/">Pwn</a></li>
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/buffer-overflow/">Buffer-Overflow</a></li>
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/canary/">Canary</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://irinasusca.github.io/writeup-blog/">Irina&#39;s CTF Writeups</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
