<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>CyberEdu ftp-console Writeup | Irina&#39;s CTF Writeups</title>
<meta name="keywords" content="CyberEdu, pwn, buffer-overflow, Ret2libc">
<meta name="description" content="Challenge overview
We got a very strange ftp console? Can you retrive the flag?

At first glance, the ftp_server looks like a 32-bit executable, and as hinted by the name, a FTP (File Transfer Protocol) server mockup.
Upon checking, every protection is disabled, so that&rsquo;s nice! Now let&rsquo;s take a look at the binary.

We have a main function that calls login, and we can already see some interesting things going on.">
<meta name="author" content="">
<link rel="canonical" href="https://irinasusca.github.io/writeup-blog/posts/ftpconsole-writeup/">
<link crossorigin="anonymous" href="/writeup-blog/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css" integrity="sha256-NDzEgLn/yPBMy&#43;XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://irinasusca.github.io/writeup-blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://irinasusca.github.io/writeup-blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://irinasusca.github.io/writeup-blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://irinasusca.github.io/writeup-blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://irinasusca.github.io/writeup-blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://irinasusca.github.io/writeup-blog/posts/ftpconsole-writeup/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="https://irinasusca.github.io/writeup-blog/posts/ftpconsole-writeup/">
  <meta property="og:site_name" content="Irina&#39;s CTF Writeups">
  <meta property="og:title" content="CyberEdu ftp-console Writeup">
  <meta property="og:description" content="Challenge overview We got a very strange ftp console? Can you retrive the flag?
At first glance, the ftp_server looks like a 32-bit executable, and as hinted by the name, a FTP (File Transfer Protocol) server mockup.
Upon checking, every protection is disabled, so that’s nice! Now let’s take a look at the binary.
We have a main function that calls login, and we can already see some interesting things going on.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-12-03T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-12-03T00:00:00+00:00">
    <meta property="article:tag" content="CyberEdu">
    <meta property="article:tag" content="Pwn">
    <meta property="article:tag" content="Buffer-Overflow">
    <meta property="article:tag" content="Ret2libc">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CyberEdu ftp-console Writeup">
<meta name="twitter:description" content="Challenge overview
We got a very strange ftp console? Can you retrive the flag?

At first glance, the ftp_server looks like a 32-bit executable, and as hinted by the name, a FTP (File Transfer Protocol) server mockup.
Upon checking, every protection is disabled, so that&rsquo;s nice! Now let&rsquo;s take a look at the binary.

We have a main function that calls login, and we can already see some interesting things going on.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://irinasusca.github.io/writeup-blog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "CyberEdu ftp-console Writeup",
      "item": "https://irinasusca.github.io/writeup-blog/posts/ftpconsole-writeup/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CyberEdu ftp-console Writeup",
  "name": "CyberEdu ftp-console Writeup",
  "description": "Challenge overview We got a very strange ftp console? Can you retrive the flag?\nAt first glance, the ftp_server looks like a 32-bit executable, and as hinted by the name, a FTP (File Transfer Protocol) server mockup.\nUpon checking, every protection is disabled, so that\u0026rsquo;s nice! Now let\u0026rsquo;s take a look at the binary.\nWe have a main function that calls login, and we can already see some interesting things going on.\n",
  "keywords": [
    "CyberEdu", "pwn", "buffer-overflow", "Ret2libc"
  ],
  "articleBody": "Challenge overview We got a very strange ftp console? Can you retrive the flag?\nAt first glance, the ftp_server looks like a 32-bit executable, and as hinted by the name, a FTP (File Transfer Protocol) server mockup.\nUpon checking, every protection is disabled, so that’s nice! Now let’s take a look at the binary.\nWe have a main function that calls login, and we can already see some interesting things going on.\nIdentifying the vulnerabilities First of all, the program leaks the location of system, so that’s great! From there on, we can easily calculate /bin/sh, at system + 0x174c32, through gef.\np.recvuntil('\\n') p.sendline(b'kkt') p.recvuntil(b': ') system = int(p.recv(10), 16) log.success(f'system: {hex(system)}') binsh = system + 0x174c32 log.success(f'binsh: {hex(binsh)}') The Exploit Now, to use this buffer overflow; We read 100 bytes in s1[32], which is at ebp - 76. For some reason the printf(\"PASS \") and printf(\"USER \") don’t appear locally for me, so I might have to modify them later, for the remote version.\nAnd so we pop a shell locally! Now let’s try remotely as well.\nThat’s, well, interesting. The ./flag.sh makes me think we did something right. I modified the p.recvuntil() to consider the printf(\"PASS \") and printf(\"USER \") as getting displayed, but we get a similar error. Maybe the error is the offset from system to /bin/sh.\nSo, using blukat with the known system value, I identified the remote version as 2.35, and guess what - shell!\nAfter a ls, the only two files we see are flag.sh and ftp_server. After digging around files for the flag, I decided to just search the entire system for it using some commands. In the end, this is what worked:\nAs always, the full code can be found on my GitHub here.\n",
  "wordCount" : "293",
  "inLanguage": "en",
  "datePublished": "2025-12-03T00:00:00Z",
  "dateModified": "2025-12-03T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://irinasusca.github.io/writeup-blog/posts/ftpconsole-writeup/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Irina's CTF Writeups",
    "logo": {
      "@type": "ImageObject",
      "url": "https://irinasusca.github.io/writeup-blog/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://irinasusca.github.io/writeup-blog/" accesskey="h" title="Irina&#39;s CTF Writeups (Alt + H)">Irina&#39;s CTF Writeups</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      CyberEdu ftp-console Writeup
    </h1>
    <div class="post-meta"><span title='2025-12-03 00:00:00 +0000 UTC'>December 3, 2025</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#challenge-overview" aria-label="Challenge overview">Challenge overview</a></li>
                <li>
                    <a href="#identifying-the-vulnerabilities" aria-label="Identifying the vulnerabilities">Identifying the vulnerabilities</a></li>
                <li>
                    <a href="#the-exploit" aria-label="The Exploit">The Exploit</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="challenge-overview">Challenge overview<a hidden class="anchor" aria-hidden="true" href="#challenge-overview">#</a></h2>
<p>We got a very strange <strong><a href="https://app.cyber-edu.co/challenges/9d17bf1a-69a7-418a-b3bb-569286ab8d7b?tenant=cyberedu">ftp console?</a></strong> Can you retrive the flag?</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/ftpconsole-writeup/pic1.png#center"></p>
<p>At first glance, the <strong>ftp_server</strong> looks like a 32-bit executable, and as hinted by the name, a FTP (File Transfer Protocol) server mockup.</p>
<p>Upon checking, every protection is disabled, so that&rsquo;s nice! Now let&rsquo;s take a look at the binary.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/ftpconsole-writeup/pic1.png#center"></p>
<p>We have a <code>main</code> function that calls <code>login</code>, and we can already see some interesting things going on.</p>
<hr>
<h2 id="identifying-the-vulnerabilities">Identifying the vulnerabilities<a hidden class="anchor" aria-hidden="true" href="#identifying-the-vulnerabilities">#</a></h2>
<p>First of all, the program leaks the location of <code>system</code>, so that&rsquo;s great! From there on, we can easily calculate <code>/bin/sh</code>, at <code>system + 0x174c32</code>, through <code>gef</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;kkt&#39;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;: &#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>system <span style="color:#f92672">=</span> int(p<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">10</span>), <span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>log<span style="color:#f92672">.</span>success(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;system: </span><span style="color:#e6db74">{</span>hex(system)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>binsh <span style="color:#f92672">=</span> system <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x174c32</span>
</span></span><span style="display:flex;"><span>log<span style="color:#f92672">.</span>success(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;binsh: </span><span style="color:#e6db74">{</span>hex(binsh)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span></code></pre></div><hr>
<h2 id="the-exploit">The Exploit<a hidden class="anchor" aria-hidden="true" href="#the-exploit">#</a></h2>
<p>Now, to use this buffer overflow; We read 100 bytes in <code>s1[32]</code>, which is at <code>ebp - 76</code>. For some reason the <code>printf(&quot;PASS &quot;)</code> and <code>printf(&quot;USER &quot;)</code> don&rsquo;t appear locally for me, so I might have to modify them later, for the remote version.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/ftpconsole-writeup/pic3.png#center"></p>
<p>And so we pop a shell locally! Now let&rsquo;s try remotely as well.</p>
<hr>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/ftpconsole-writeup/pic4.png#center"></p>
<p>That&rsquo;s, well, interesting. The <code>./flag.sh</code> makes me think we did something right. I modified the <code>p.recvuntil()</code> to consider the <code>printf(&quot;PASS &quot;)</code> and <code>printf(&quot;USER &quot;)</code> as getting displayed, but we get a similar error. Maybe the error is the offset from <code>system</code> to <code>/bin/sh</code>.</p>
<p>So, using <a href="https://libc.blukat.me/?q=system%3A0xf7d79170&amp;l=libc6_2.35-0ubuntu3.11_i386">blukat</a> with the known <code>system</code> value, I identified the remote version as <code>2.35</code>, and guess what - shell!</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/ftpconsole-writeup/pic5.png#center"></p>
<p>After a <code>ls</code>, the only two files we see are <code>flag.sh</code> and <code>ftp_server</code>. After digging around files for the flag, I decided to just search the entire system for it using some commands. In the end, this is what worked:</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/ftpconsole-writeup/pic6.png#center"></p>
<hr>
<p>As always, the full code can be found on my GitHub
<strong><a href="https://github.com/irinasusca/ctf-writeups/blob/main/pico/ftpconsole.py">here</a></strong>.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/cyberedu/">CyberEdu</a></li>
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/pwn/">Pwn</a></li>
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/buffer-overflow/">Buffer-Overflow</a></li>
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/ret2libc/">Ret2libc</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://irinasusca.github.io/writeup-blog/">Irina&#39;s CTF Writeups</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
